<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Guillaume Allègre">
<meta name="author" content="Muriel Pucci">
<meta name="dcterms.date" content="2025-01-13">
<meta name="keywords" content="Assistance, Prime d’activité, Trappes à inactivité, Incitations à l’emploi">

<title>La reprise d’emploi est-elle toujours rémunératrice?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="PB_GainEmploi-CES203B-2-C-FW_files/libs/clipboard/clipboard.min.js"></script>
<script src="PB_GainEmploi-CES203B-2-C-FW_files/libs/quarto-html/quarto.js"></script>
<script src="PB_GainEmploi-CES203B-2-C-FW_files/libs/quarto-html/popper.min.js"></script>
<script src="PB_GainEmploi-CES203B-2-C-FW_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="PB_GainEmploi-CES203B-2-C-FW_files/libs/quarto-html/anchor.min.js"></script>
<link href="PB_GainEmploi-CES203B-2-C-FW_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="PB_GainEmploi-CES203B-2-C-FW_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="PB_GainEmploi-CES203B-2-C-FW_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="PB_GainEmploi-CES203B-2-C-FW_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="PB_GainEmploi-CES203B-2-C-FW_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">La reprise d’emploi est-elle toujours rémunératrice?</h1>
<p class="subtitle lead">Si oui, quel est le vrai problème ?</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Guillaume Allègre <a href="mailto:guillaume.allegre@sciencespo.fr" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            OFCE, Sciences Po Paris
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Muriel Pucci <a href="mailto:muriel.pucci@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            OFCE &amp; Université Paris 1
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 13, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">January 13, 2025</p>
    </div>
  </div>
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    Depuis les réformes visant à permettre aux personnes de cumuler revenus professionnels et prestations sociales, la reprise d’emploi est toujours rémunératrice, masi elle ne permet pas toujours de sortir de la pauvreté. Cela s’explique notamment par le fait que le revenu minimum garanti aux personnes d’âge actif est très faible et maintient la plupart du temps les personnes sans emploi sous le seuil de grande pauvreté : le travail paie, mais les travailleurs partent de trop bas.
  </div>
</div>

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>Assistance, Prime d’activité, Trappes à inactivité, Incitations à l’emploi</p>
  </div>
</div>

</header>


<div id="socialshare">

</div>
<section id="introduction-les-objectifs-de-la-lutte-contre-la-pauvreté-par-lemploi" class="level1">
<h1>Introduction : les objectifs de la lutte contre la pauvreté par l’emploi</h1>
<p>Y a-t-il de bonnes raisons de reprendre un emploi payé au salaire minimum quand on touche des prestations sociales ? La question des gains liés à la reprise d’emploi est récurrente dans un contexte où les aides sociales sont critiquées pour leur trop grande générosité et où les politiques de tout bord insistent sur la valeur travail. Le travail doit payer, et bien plus que l’assistance.</p>
<p>C’est ce qu’a encore demandé le Premier ministre le 3 octobre 2024 sur France 2. “Il faut que le travail paie plus que l’addition des allocation” a déclaré Michel Barnier, qui entend lancer le “chantier de l’allocation sociale unique”, afin que “cela paye plus de travailler que de ne pas travailler”. La stratégie nationale de prévention et de luttre contre la pauvreté (SNPLP), publiée en 2018 était même plus précise, puisqu’un des objectifs, alors assigné à un “revenu universel d’activité” est de “faire en sorte que le travail paye et qu’il paye de la même façon dans tous les cas”. Nous verrons que le travail est certe rémunérateur, mais qu’il paye différemment selon la situation familiale.</p>
<p>Un deuxième objectif donné aux politiques de lutte contre la pauvreté est de faire en sorte que le travail sorte de la pauvreté. Cet objectif est inscrit dans la SNPLP (2018) soit “l’engagement d’une politique déterminée de sortie de la pauvreté par le travail”. S’il est implicitement admis que les peronnes sans emploi puissent vivre sous le seuil de pauvreté, être pauvre bien que travailleur, travailleur mais pauvre, est perçu comme une anomalie que les politiques publiques doivent corriger (Allègre, 2024).</p>
<p>Enfin un troisième objectif attribué aux politiques de lutte contre la pauvreté est de “garantir un soutien financier aux ménages modestes” (SNPLP, 2018). Dans la stratégie de lutte contre la pauvreté, cet objectif est le plus souvent lié aux enfants et aux familles. Un des objectifs est de “garantir l’accès de tous les enfants aux biens et aux services essentiels” ; l’affirmation “la stratégie pauvreté déploiera enfin des mesures concrètes et ancrées dans le quotidien des Français pour réduire les privations” est affirmé dans le chapitre nommé “garantir au quotidien les droits fondamentaux des enfants”. S’il est admis que les personnes sans emploi puissent petre pauvres, il ne faut pas que leurs privations soient trop sévères, en particulier losrqu’elles ont des enfants.</p>
<p>Plus généralement, “réduire les privations”, “garantir les droits fondamentaux” sont des objectifs qui concernent tout le monde, adultes et mineurs. Depuis 1946, le préambule de la Constitution affirme ainsi “Tout être humain qui, en raison de son âge, de son état physique ou mental, de la situation économique, se trouve dans l’incapacité de travailler a le droit d’obtenir de la collectivité des moyens convenables d’existence”. Toutefois la façon dont ce droit est écrit ne définit pas explicitement ces moyens convenables d’existence et ne dit pas s’ils doivent être procurés en nature (logement, santé, aide alimentaire…) ou en espèces. Alors que ce préambule date de 1946, le RMI n’a été mis en place qu’en 1989. Pour les foyers sans revenus, le RMI puis le RSA garantissent des niveaux de vie proches selon les configurations familiales, et en particulier selon la présence d’enfants ou non (graphique fig_xxx).</p>
<p>Pour résumer, la lutte contre la pauvreté repose sur au moins trois objectifs, régulièrement réaffirmés par les pouvoirs publics :</p>
<p>1. Faire en sorte que le travail paie ;</p>
<p>2. Faire en sorte que le travail fasse sortir de la pauvreté ;</p>
<p>3. Garantir à tous la couverture des besoins essentiels ou minimaux.</p>
<p>Les trois premières parties de ce document évaluent le système actuel par rapport à ces trois objectifs. Dans la quatrième partie, plus prescriptive, <strong><em>nous verrons ce qu’il faudrait faire si l’on veut atteindre simultanément ces trois objectifs (BOF).</em></strong></p>
<section id="la-reprise-demploi-est-toujours-rémunératrice-mais-pas-toujours-de-la-même-façon." class="level2">
<h2 class="anchored" data-anchor-id="la-reprise-demploi-est-toujours-rémunératrice-mais-pas-toujours-de-la-même-façon.">1. La reprise d’emploi est toujours rémunératrice, mais pas toujours de la même façon.</h2>
</section>
<section id="une-analyse-par-cas-type" class="level2">
<h2 class="anchored" data-anchor-id="une-analyse-par-cas-type">1.1. Une analyse par cas-type</h2>
<p>La reprise d’emploi est-elle rémunératrice ? Pour répondre à la question de façon concrète, nous raisonnons sur cas-type. Il s’agit d’illustrer les gains à la reprise d’emploi en prenant des exemples-type de situations de travail, de configuration familiale, de logement (pour calculer les allocations-logement) et de gardes (lorsqu’on calcule des frais de garde éventuelles). Dans ces situations, les gains à la reprise d’emploi, proviennent des salaires nets perçus et de la Prime d’activité. Les “coûts” proviennent de l’augmentation de l’impôt sur le revenu et de la baisse des prestations sociales (RSA, Allocations logement, allocations familiales…). La variable d’intérêt est le revenu disponible qui est calculé au niveau du ménage et ne tient pas compte de la répartition interindividuelle des revenus au sein des couples. L’analyse porte sur la variation du revenu disponible lorsqu’une personne passe de l’inactivité ou du chômage à l’emploi sans tenir compte des coûts à la reprise d’emploi en termes de transport ou d’habillement.</p>
<dl>
<dt><em>Définition : taux marginal effectif de prélèvement</em></dt>
<dd>
<p><em>Outre la variation de revenu disponible du ménage, il est également possible de calculer un taux marginal effectif de prélèvement (TMEP) qui correspond à la part de l’augmentation du revenu professionnel qui est compensée par une hausse des impôts une une baisse des prestations et ne se traduit donc pas en augmentation de revenu disponible.</em> <em>Si lorsque le revenu d’activité augmente de 1000 euros, le revenu disposible n’augmente que de 600 euros, on dira que le TMEP est de 40%.</em></p>
<p><span class="math display">\[TMEP=1-\frac{\text{Variation du revenu disponible}}{\text{Variation du revenu professionnel}}\]</span></p>
</dd>
</dl>
<p>Le cas-type général commenté dans le texte est celui d’un ménage éligible, sous condition de ressources, au RSA (l’individu référent est âgé entre 25 et 64 ans) et aux allocations logement<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> (le ménage est locataire du parc privé). Pour les ménages non éligibles à ces prestations, les presations sociales sont bien plus faibles, et les gains à la reprise d’emploi sont donc par construction beaucoup plus importantes. Pour les ménages avec enfants, nous supposons dans le cas général que les enfants sont d’âge scolaire (5, 8 ou 10 ans) mais la situation des familles ayant un efant en bas âge qui nécessite un mode de garde est étudiée dans l’encadré XX.</p>
<p>Trois situations de reprise d’emploi sont analysées : le mi-temps au smic horaire (699 euros mensuels), le temps-plein au smic horaire (1399 euros mensuels) et le temps plein à 1,5 smic horaire (2098 euros mensuels). Pour les couples, ces reprises d’emploi sont analysées dans le cas d’un conjoint inactif sans revenu, d’un conjoint chômeur (avec un montant d’allocation chômage égal au smic mensuel) et d’un conjoint en emploi à temps-plein gagnant le smic ou 1,5 fois le smic. L’analyse n’est pas genrée, mais dans les couples, ce sont le plus souvent les femmes qui prennent des emplois à mi-temps, à la fois parce que le partage des tâches reste très inégalitaire et parce qu’elles ont des emplois dans des secteurs où elles plus sont plus susceptibles d’être en temps-partiel subi. L’analyse est descriptive et ne présume pas que les ménages ou individus ont le choix entre les différentes combinaisons de travail. Comme son nom l’indique le salaire minimum constitue un plancher : 85% des salariés ont un salaire supérieur et pour ces salariés, les écarts de revenu disponible entre les personnes en emploi et les bénéficiaires du RSA sont plus élevés <strong>(ref Devetter &amp; Valentin)</strong>.</p>
<p>Les tableaux dynamiques permettent de tester plus de configurations.</p>
</section>
<section id="des-reprises-demploi-rémunératrices" class="level2">
<h2 class="anchored" data-anchor-id="des-reprises-demploi-rémunératrices">1.2 Des reprises d’emploi rémunératrices</h2>
<p>Dans les cas types étudiés, le système socio-fiscal actuel garantit que la reprise d’emploi est toujours rémunératrice, mais pas nécessairement toujours dans les mêmes proportions.</p>
<p>Le cas d’une personne seule illustre la façon dont le système socio-fiscal assure que le travail paie mieux que l’assistance, même pour de petites durées de travail. Sans revenus d’activité, cette personne peut percevoir 851 euros de prestations sociales (559 euros de RSA et 292 euros d’allocations logement), ce qui est juste en dessous du seuil de grande pauvreté à 40% du niveau de vie médian<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
<p>Si cette personne reprend un emploi rémunéré au Smic, son revenu disponible augmente que l’emploi soit à temps partiel ou à temps plein, en dépit de la baisse du montant de prestations sociales. Avec un emploi à mi-temps, le revenu disponible est de 1 191 euros et le taux marginal effectif de prélevement (TMEP) est de 51,4%, ce qui veut dire que les ménages gardent en revenu disponible 48,6% de l’augmentation de leurs revenus d’activité (soit 340 euros sur les 699 euros de salaire reçu). Avec un emploi à temps-plein, le revenu disponible double quasiment (+94%) et atteint 1656 euros (soit une hausse de 805 euros) avec un TMEP de 42,5%. Si l’emploi à temps plein est rémunéré à 1,5 smic, le niveau de vie atteint 2 016 euros (hausse de 1 165 euros) et le TMEP est de 44,5%. <strong><em>commenter plus les variations de MS/PL/IR</em></strong></p>
<p>Pour un couple avec deux enfants (âgés de 5 et 8 ans) initialement sans revenu et dont un des conjoints reprend un emploi à plein-temps, le gain de revenu disponible en euros est de 845 euros, soit un gain très proche de celui du célibataire sans enfant, et par conséquent un TMEP également similaire (40%). Si le gain en euro est similaire, ce couple a un revenu disponible plus important en situation d’inactivité (1 652 euros) et le gain relatif est donc moindre (+51%). De plus, ce couple comporte davantage d’unités de consommation que le célibataire et pour une augmentation équivalente du revenu disponible, le gain en niveau de vie est deux fois plus faible que pour le célibataire sans enfant (402 euros par UC). <strong><em>commenter plus les variations de MS/PL/IR</em></strong></p>
<dl>
<dt><em>Définition : niveau de vie</em></dt>
<dd>
<p><em>Le calcul du niveau de vie d’un ménage a pour objet de comparer les revenus disponibles de ménages de configuration différentes en tenant compte des économies d’échelle liées à la vie commune et des besoins des enfants. Il est obtenu en divisant le revenu disponible de l’ensemble du ménage par un nombre d’unités de consommation. En France et en Europe, les unités de consommation sont calculées par l’INSEE et Eurostat selon l’échelle d’équivalence dite de l’OCDE modifiée qui attribue 1 UC au premier adulte du ménage, 0,5 UC aux autres personnes de 14 ans ou plus et 0,3 UC aux enfants de moins de 14 ans (car considérés ayant moins de besoins).</em></p>
</dd>
</dl>
<p>La situation est un peu différente pour une personne en couple avec deux enfants si le conjoint est actif en emploi, rémunéré sur la base d’un Smic mensuel. Dans ce cas, le revenu disponible du couple avec deux enfants est de 2 497 euros en cas de monoactivité et la reprise d’emploi à temps plein au smic est plus rémunératrice car la dégressivité des aides est moindre. Le gain associé au second emploi dans le couple est de 911 € ce qui correspond à un TMEP de 35%. <strong><em>commenter plus les variations de MS/PL/IR</em></strong></p>
<p>Enfin, si le conjoint est au chômage et perçoit une allocation d’un montant égal au Smic mensuel, le revenu du couple est de 1891 euros seulement lorsque la personne est inactive et de 2981 euros (+1090 euros) si elle travaille à temps plein au smic, ce qui correspond à un TMEP de 22%.</p>
<p>Le système social et fiscal remplit donc l’objectif qui lui a été fixé depuis la mise en place du RSA&nbsp;en 2009 : rendre le travail plus rémunérateur que l’assistance, de façon pérenne et pour toutes les reprises d’emploi. Toutefois les gains de reprise d’emploi ne sont pas homogènes, ce qui se voit en creux par la forte variabilité des taux marginaux effectifs de prélèvement. <strong><em>Mettre un graphique avec les TMEP de toutes les config pour un temps plein au smic (option mi-temsp et 1,5 smic) et refaire les commentaires.</em></strong> Dans les cas que nous étudiés, <strong><em>le taux varie de 6% pour le passage de la monoactivité à la biactivité d’un couple sans enfant, à 42% pour une personne seule passant de l’inactivité à l’activité à temps-plein. Le premier garde ainsi 94% de l’augmentation de ses revenus d’activité et le second 58%.</em></strong> <strong><em>Mais le premier est initialement beaucoup plus pauvre, et donc plus aidé. Le second cumule deux bonus individuels de prime d’activité.</em></strong></p>
<dl>
<dt><em>La prime d’activité</em></dt>
<dd>
<p><em>Depuis le 1er janvier 2016, la Prime d’activité a remplacé le RSA activité et la prime pour l’emploi. Comme les instruments qu’elle remplace, la prime d’activité vise deux objectifs : soutenir l’offre de travail grâce à des incitations financières accrues et compléter les revenus des travailleurs ayant des revenus modestes. <strong>La prime pour l’emploi et le RSA activité ont été critiqués pour leur faible efficacité.</strong> Individualisée, la prime pour l’emploi versait de faibles montants à de nombreux bénéficiaires : trop faible pour être véritablement incitative, elle bénéficiait de plus à des ménages à niveau de vie intermédiaire et non aux plus modestes. Le RSA activité tenait compte de la composition et du revenu du ménage : il était davantage ciblé sur les travailleurs pauvres et créait des incitations à la reprise d’emploi substantielles et contemporaines. Néanmoins, son efficacité était minée par un non-recours élevé (68 %).</em></p>
<p><em>La prime d’activité est proche dans son fonctionnement du RSA activité : familialisée, versée mensuellement, après une déclaration trimestrielle de revenus, elle cible les travailleurs aux revenus modestes et conserve les incitations à la reprise d’emploi. Elle est en outre clairement identifiée comme une prestation à destination des personnes exerçant une activité, ce qui évite qu’elle apparaisse stigmatisante aux yeux de ceux qui la perçoivent. Par conséquent, le non-recours <strong>(pas d’estimations précises - donner ref pour approx)</strong> est <strong>probablement</strong> bien plus faible que celui qui était observé pour le RSA activité.</em></p>
<p><em>La formule de calcul de la prime d’activité est la suivante :</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 69%">
</colgroup>
<tbody>
<tr class="odd">
<td><em>Prime d’activité du foyer =</em></td>
<td><em>Montant forfaitaire qui dépend de la situation familiale</em></td>
</tr>
<tr class="even">
<td></td>
<td><em>+ bonus d’activité individuels</em></td>
</tr>
<tr class="odd">
<td></td>
<td><em>- (forfait logement + prestations familiales + autres minima sociaux)</em></td>
</tr>
<tr class="even">
<td></td>
<td><em>- 39 % des revenus professionnels</em></td>
</tr>
<tr class="odd">
<td></td>
<td><em>- 100 % des revenus non professionnels</em></td>
</tr>
</tbody>
</table>
<p>Le montant de la prime d’activité versée au foyer est nul si le résultat de ce calcul est inférieur à 15 euros.</p>
<p>Si elle permet de garantir des gains entre inactivité et revenus du travail dans presque toutes les configurations, la prime d’activité a des limites. Par rapport à une hausse du Smic, c’est une prestation sociale et pas un salaire donnant des droits sociaux (chômage, retraites). Comme la formule le montre, les revenus non professionnels du foyer sont déduits à 100%. Dans un couple, si l’un des conjoints perd son emploi pour du chômage indemnisé, non seulement il perd son bonus d’activité individuel, mais son chômage est déduit de la prime de son conjoint. Par conséquent, dans la plupart des cas, les ménages incluant un chômeur indemnisé (ou un retraité) ne touchent pas de prime d’activité . Enfin, bien que visant à lutter contre les trappes, les compléments de revenus pour travailleurs pauvres sont critiqués par les trappes qu’ils créent (au-dessus) : ciblés sur le temps-partiel, ils créent une trappe à précarité ; ciblés sur le temps-plein, comme la prime d’activité, ils renforcent la trappe à bas-salaire. En matière d’incitations, ces compléments ciblés dégressifs ne peuvent que creuser une nouvelle trappe pour en reboucher une : si la prime augmente l’écart entre emploi et avec chômage ou inactivité, elle ne peut que réduire le gain de niveau de vie permis par une hausse de salaire.</p>
</dd>
</dl>
</section>
</section>
<section id="lemploi-ne-protège-pas-toujours-de-la-pauvreté-monétaire." class="level1">
<h1>2. L’emploi ne protège pas toujours de la pauvreté monétaire.</h1>
<p>Si l’emploi est toujours rémunérateur, il ne protège pas toujours de la pauvreté monétaire. Ceci apparaît clairement sur cas types mais peut se voir également par l’existence d’une pauvreté en emploi, même our des bénéficiaires de la prime d’activité<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. En 2022, selon l’INSEE le taux de pauvreté sur l’ensemble de la population était de 14,4%. Le taux de pauvreté monétaire des personnes en emploi était de 7,7% <strong>et de xx% en se limitant aux allocataires dela prime d’activité</strong>. L’emploi réduit ainsi beaucoup le risque de pauvreté monétaire mais ne l’annule pas : sur les 9,1 millions de personnes vivant sous le seuil de pauvreté monétaire, 2 millions sont en emploi (INSEE). <strong>ajouter stats selon nombre d’emplois/quotité</strong></p>
<dl>
<dt><em>Définition : la pauvreté monétaire</em></dt>
<dd>
<p><em>D’après la statistique publique (INSEE, Eurostat), un individu est pauvre d’un point de vue monétaire, si le niveau de vie du ménage auquel il appartient est inférieur à 60% du niveau de vie médian. La pauvreté monétaire est ainsi un concept relatif : si le niveau de vie de tous les ménages augmente de 10%, la pauvreté monétaire reste stable. Par convention, le seuil de pauvreté monétaire est le même dans tout le pays, mais il varie au sein de l’Union Européenne d’un pays à l’autre. La pauvreté est définie par les revenus. La seule prise en compte des besoins se fait à travers la composition familiale (nombre d’individus et âge des enfants). Le niveau de vie ne prend ainsi pas en compte le coût du logement ni les besoins différenciés en transport, logement ou chauffage selon le lieu de vie.</em></p>
<p><em>Le dernier seuil de pauvreté publié par l’Insee est de 1216 euros par UC pour l’année 2022. Pour le comparer aux montants des prestations en 2024, nous avons appliqué à ce seuil l’inflation observée entre 2022 et juillet 2024, ce qui amène à un seuil de 1309 euros par UC.</em></p>
</dd>
</dl>
<p>Le niveau de vie d’un célibataire sans enfant sans revenus d’activité et recourant à toutes les prestations est de 851 euros/uc ce qui est inférieur de 35% au seuil de pauvreté monétaire : son intensité de pauvreté est donc de 35%. Un emploi à mi-temps au Smic ne lui permet pas de franchir le seuil de pauvreté (intensité de 9%). Le célibataire sans enfant franchit le seuil de pauvreté avec un Smic à plein temps (son niveau de vie atteint 126% du seuil).</p>
<p>Une personne isolée avec enfant(s) en emploi à plein-temps au Smic est au-dessus du seuil de pauvreté monétaire, qu’elle ait un enfant (125%) du seuil), deux enfants (119%), ou trois enfants (124%). Le système socio-fiscal permet donc bien de sortir les parents isolées de la pauvreté lorsqu’elles travaillent au Smic à temps plein. <strong><em>quid mi-temps ?</em></strong></p>
<p>Les revenus d’un couple monoactif dans lequel l’un des conjoints travaille au Smic à plein-temps, et l’autre conjoint est en inactivité; permettent tout juste d’atteindre le seuil de pauvreté si le couple n’a pas d’enfant. Dans ce cas, le niveau de vie est égal à 100% du seuil de pauvreté. A ce niveau de revenus, le système social ne compense pas entièrement la charge des enfants, et le niveau de vie des couples monoactifs avec enfants est légèrement plus faible. Ces ménages ont donc des revenus qui les placent sous le seuil de pauvreté monétaire, avec une intensité de pauvreté de 7% s’ils ont 1 enfant, 9% avec 2 enfants, et 5% avec 3 enfants.</p>
<p>Les couples biactifs avec deux emploi au Smic à temps-plein ont un revenu disponible qui leur permet de dépasser le seuil de pauvreté monétaire. A ce niveau de revenus, le système fiscal et social ne compense que partiellement la charge des enfants telle qu’elle est appréhedée par les unités de ocnsommation. Un couple biactif au Smic a ainsi un niveau de vie équivalent à 142% du seuil de pauvreté s’il n’a pas d’enfant, 119% du seuil de pauvreté s’il en a un, 108% avec deux enfants et 110% avec trois.</p>
<p><strong>réfléchir aux stats à produire avec l’ERFS ou INes</strong></p>
</section>
<section id="le-revers-des-incitations-est-laugmentation-de-lintensité-de-la-pauvreté-des-personnes-sans-emploi." class="level1">
<h1>3. Le revers des incitations est l’augmentation de l’intensité de la pauvreté des personnes sans emploi.</h1>
<p>Le niveau de vie des ménages sans revenus d’activité est faible, et a décru dans le temps. En outre, <strong>depuis xxxx,</strong> le niveau du minimum social en direction des personnes d’âge actif a progressé bien moins vite que le niveau du minimum vieillesse (ASPA) ou de l’allocation adulte handicapée (AAH) <strong>(graphique ou réf)</strong>.</p>
<p>En 1989, la loi instaurant le RMI a pour principal objectif de donner un minimum social pour les personnes valides d’âge actif. Si l’objectif est principalement distributif, le législateur a néanmoins voulu préserver les incitations à travailler <strong><em>en fixant le niveau du RMI à 50 % du SMIC à temps plein</em></strong> . Les débats font alors apparaître la volonté de garder une norme d’emploi à plein-temps. Dans les années 1990, le nombre d’allocataires augmente rapidement et atteint un niveau non anticipé par les décideurs publics : de 500 000 allocataires en 1990, ce nombre dépasse le million en 1996. Face à cette montée rapide, le discours sur les « trappes à pauvreté » se répand. En 2001, l’introduction de la prime pour l’emploi (PPE) est une première réponse à ce discours. La PPE étant accusée d’être mal ciblée et de pénaliser les emplois à temps partiel, le RSA activité prend la relève en 2009 et permet de garantir que le revenu disponible d’un foyer augmente lorsque ses revenus d’activité augmentent, même à temps partiel ou très partiel. Il est ensuite remplacé par la prime d’activité en 2015, revalorisée lors de la crise des gilets jaunes <strong>pour les salaires proches du smic</strong>. Durant cette période d’attention aux gains à l’emploi et à la pauvreté laborieuse, le montant de base du RSA est peu revalorisé. <strong>citaton de Nicolas sur le paradoxe incitation/précarisation</strong></p>
<p>Pourtant, malgré l’augmentation des gains à la reprise d’emploi via le creusement de l’écart entre le RSA et le SMIC et la montée en charge des compléments de revenus pour travailleurs pauvres, la part d’allocataires du RSA dans la population d’âge actif a augmenté, passant de 3,0% en 2008 à 4,1% en 2022. La réduction du niveau de vie relatif du RSA n’a donc pas eu d’effets visibles en termes de baisse du nombre d’allocataires.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-minima" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-pos="H">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-minima-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="PB_GainEmploi-CES203B-2-C-FW_files/figure-html/fig-minima-1.png" class="img-fluid figure-img" data-fig-pos="H" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-minima-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Evolution des mimina sociaux et du Smic horaire
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="que-faire-si-lon-prend-la-lutte-contre-la-pauvreté-au-sérieux" class="level1">
<h1>4. Que faire si l’on prend la lutte contre la pauvreté au sérieux ?</h1>
<p>Le système social et fiscal remplit donc l’objectif qui lui a été fixé depuis la mise en place du RSA en 2009&nbsp;: rendre le travail plus rémunérateur que l’assistance. Mais avoir un emploi rémunéré au Smic n’est pas un gage de sortie de la pauvreté, et vivre sans emploi implique souvent d’être dans une situation de grande pauvreté. Que faire ? <strong>Une solution passe par la réglementation du marché du travail (à rediger)… Les pistes que nous explorons ici prennent comme donnése la structure des emplois offerts et le développement de l’auto-entreprenariat précaire et reposent principalement sur des aménagements de dispositifs actuels.</strong></p>
<section id="augmenter-le-socle" class="level2">
<h2 class="anchored" data-anchor-id="augmenter-le-socle">4.1. Augmenter le socle</h2>
<p>Dans le système actuel, il est possible de concilier les trois objectifs&nbsp;-&nbsp;travail rémunérateur, travail permettant de sortir de la pauvreté et niveau de vie minimum suffisamment élevé&nbsp;- en relevant le montant des prestations de solidarité (RSA et aides au logement).</p>
<p>Le RSA pourrait être revalorisé de sorte qu’un foyer sans emploi atteigne 50&nbsp;% du niveau de vie médian, soit 1&nbsp;090&nbsp;euros pour une personne isolée sans enfant, et 2&nbsp;290&nbsp;euros pour un couple avec deux enfants. Avec les aides au logement actuelles, pour la personne seule vivant en zone&nbsp;2 (villes de plus de 100&nbsp;000&nbsp;habitants), cela amènerait le montant du RSA à <strong>798&nbsp;euros avant forfait logement (et xx€ après)</strong>.</p>
<p>En conservant les incitations actuelles, par alignement du socle de la prime d’activité sur le RSA, cette revalorisation permettrait aux couples avec deux enfants de franchir le seuil de pauvreté monétaire avec un seul emploi au Smic à temps plein. <strong>Graphique illustratif</strong></p>
<p>Dans le système actuel, le travail est plus rémunérateur que l’assistance car la prime d’activité compense le faible niveau du Smic <strong>horaire et la prévalence des emplois rémunérés en dessous du smic mensuel</strong>. Si les personnes en emploi restent pauvres malgré les allocations et les incitations… c’est qu’ils partent de trop bas.</p>
</section>
<section id="le-smic-ou-la-prime-dactivité" class="level2">
<h2 class="anchored" data-anchor-id="le-smic-ou-la-prime-dactivité">4.2 Le Smic ou la prime d’activité ?</h2>
<p>Faut-il privilégier le soutien aux bas-salaires via le Smic<strong>, ( enlever éventuellement compensé par des exonérations de cotisations, )</strong> ou via la prime d’activité, et notamment les bonus individuels ?</p>
<p>La prime d’activité n’est pas un salaire :</p>
<ul>
<li><p>Le salaire est totalement individualisé : le bénéfice de la prime our un travailleur à bas salaire dépend de la composition de sa famille, du montant et de la nature des revenus de son conjoint</p></li>
<li><p>Le salaire est le plus souvent prévisible, au moins un minorant du salaire (en présence d’heures supplémentaires ou de part variable) : les travailleurs peuvent difficilement révoir le montant de la prime d’activité compte tenu de son mode de calcul et des risques d’indus et rappels.</p></li>
<li><p>le salaire procure des droits sociaux : le taux de remplacemet au chomage ou à la retraite est réduit pour les bénéficiaires de la prime</p></li>
</ul>
<p>Il y a 2 objectifs. Le premier objectif est la redistribution, la lutte contre la pauvreté et la réduction des écarts de niveaux de vie, par construction familialisée. Le deuxième objectif est le soutien aux bas-salaires, dans une logique de mérite, par construction individualisé. L’hybridation de ces deux logiques, la lutte contre la pauvreté laborieuse, crée des situations paradoxales car la pauvreté suit une logique familiale et le travail est individuel (Allegre, xxxx ; Ponthieux xxxx). <strong>idée : renvoyer à l’origine des prestations familiales avec les sursalaires familiaux : l’emploi permet aux travailleurs sans enfant de vivre décemment (modèle couple monoactif), les PF compensent les charges d’enfant (pour éviter une hausse généralisée des salaires sous la pression des travailleurs avec enfants)</strong></p>
<p><strong>Si l’on donne un poids à l’objectif de réduction de la pauvreté laborieuse, au-delà de celui que l’on donne à l’objectif de réduction de la pauvreté, alors il est préférable que certains pauvres ne travaillent pas (puisque le fait qu’ils travaillent augmentent la pauvreté laborieuse). Si l’on préfère toujours que les pauvres travaillent plus alors l’objectif n’est pas la réduction de la pauvreté laborieuse mais la réduction efficiente de la pauvreté. La réduction est efficiente dans la mesure où l’emploi réduit le coût de la redistribution pour les contribuables.</strong></p>
<p><strong>S’il y a 2 objectifs distincts, alors selon le principe de Tinbergen, il faut affecter prioritairement à des instruments distincts la poursuite de ces objectifs. D’une part, le RSA et une prime d’activité entièrement familialisée doivent poursuivre l’objectif de lutte contre la pauvreté et les inégalités de niveau de vie. Dans cette architecture, il faudrait réfléchir à étendre le bénéfice de la prime d’activité aux chômeurs (les travailleurs sans emploi). D’autre part, le Smic doit être l’instrument monétaire privilégié de soutien aux bas-salaires. Mais si l’objectif est la lutte efficiente contre la pauvreté, alors il faut éviter que les entreprises reposent sur le système social pour proposer des emplois qui ne seraient pas viables par ailleurs (voir Devetter, Pucci et Valentin 2020 et la section suivante).</strong></p>
<p><strong>parler de l’instabilité et de l’avantage qu’avait la PPE : presta sur base fiscale sans risque d’indus (sauf fraude et ceux qui demandaient la mensualisation)</strong></p>
</section>
<section id="quelle-place-pour-le-temps-partiel" class="level2">
<h2 class="anchored" data-anchor-id="quelle-place-pour-le-temps-partiel">4.3 Quelle place pour le temps partiel ?</h2>
<p>Faut-il cibler les compléments de revenus pour travailleurs au niveau du temps-partiel ou du temps-plein ? Posé comme cela, le problème est insoluble : pour protéger de la pauvreté, il vaut mieux inciter au temps-plein ; mais pour réduire directement la pauvreté laborieuse, il vaut mieux donner plus aux travailleurs à temps-partiel, qui ont des niveaux de vie plus faibles. En réalité redistribution et incitations sont des objectifs contradictoires : la redistribution implique de réduire les écarts de revenus disponibles entre non-emploi, emploi et emploi mieux rémunéré, tandis que l’incitation implique de les maintenir ou de les augmenter.</p>
<p>S’ajoute un autre objectif : le mérite. Selon cet objectif, l’augmentation des revenus d’activité doit s’accompagner d’une augmentation du revenu disponible, même en l’absence d’impact incitatif en termes d’emploi. Il est probable que beaucoup d’acteurs ont cet objectif en tête lorsqu’ils défendent l’idée que le travail doit payer (Allègre, 2011). <strong>précise ta pensée</strong></p>
<p>Le problème est que créer un écart de revenus à la fois entre l’inactivité et le mi-temps et entre le mi-temps et le temps-plein est probablement une des raisons de la dévalorisation du socle. En 1989, la norme d’emploi était <strong>le CDI à temps-plein</strong>, et le niveau du RMI a été choisi pour créer un écart avec l’emploi au Smic à temps-plein (il a été fixé en décembre 1988 à 50% du Smic à temps-plein). La prestation était différentielle : après période d’interessement temporaire (<strong>à préciser</strong>), chaque euro de revenus supplémentaires se déduisait à 100% du revenu versé. Cela veut dire qu’à terme une personne seule reprenant un emploi à mi-temps n’avait aucun gain financier. Les gains étaient concentrés entre le mi-temps et le temps-plein. <strong>Pourtant, il y avait des reprises d’emploi à temps partiel et même du cumul RSA-emploi (ref Petour Zajdela par exemple)</strong></p>
<p>Faut-il revenir à une prestation différentielle ? Une possibilité est de revenir au système du RMI, qui permet à la fois un socle plus élevé et de réaffirmer le temps-plein comme norme de travail. Le problème est que cette norme s’est dégradée et qu’il est peut-être préférable de la renforcer, non pas avec des mesures qui visent les travailleurs et l’offre de travail, mais avec des mesures qui visent les entreprises. <strong>A préciser</strong></p>
<p>Il faut donc réaffirmer le droit à un travail à temps-plein et lutter contre le travail à temps-partiel contraint. Comment ? Devetter, Pucci et Valentin montrent que le Smic n’est pas une protection suffisante contre la pauvreté des travailleurs, du fait du temps partiel contraint dans des métiers dont le taux horaire est faible. Le seuil de bas salaire mensuel (défini à 60% du salaire médian) étant proche du Smic mensuel, par construction les bas salaires manquent d’heures dans le mois par rapport à un temps-plein. Les métiers les plus touchés par les bas salaires sont les métiers du care, assistantes maternelles, aides à domicile (66% de bas salaires), les métiers du nettoyage (47%), les métiers de l’hottellerie-restauration (50%). Ces trois secteurs concentrent 43% des bas-salaires mensuels. Or ces professions concentrent forte amplitude de la journée de travail et faible densité de la journée de travail :</p>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>On suppose que le ménage est locataire en zone 2 des aides au logement (ville moyenne) pour un loyer compris entre 1 et 2,5 fois le loyer plafond.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Son niveau de vie équivaut à 39% du niveau de vie médian.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Si la prime d’activité permet à certains foyers de franchir le seuil de pauvreté monétaire, l’analyse par cas types montre que certains foyers à bas salaire n’y sont pas éligibles. S’y ajoutent ceux qui ne recourent pas à cette prestation bien que leur niveau de vie soit inférieur au seuil de pauvreté monétaire.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>