"0","#| fig-cap: Taux de pauvreté et taux de privation matérielle selon la tranche de revenu salarial et la configuration familiale"
"0",""
"0","srcv<-read_excel(""data/Sorties_Privation.xlsx"",sheet = ""Sorties_Privation"")"
"0",""
"0","base1 <- srcv %>%"
"0","pivot_longer(cols = c(TX_PAUVRETE, TX_ISO_PAUVRETE, TX_COU_PAUVRETE), names_to = ""cas"", values_to = ""taux"") %>%"
"0","  select(modalite, cas, taux) %>%"
"0","  filter(modalite!=""Ensemble"") %>% "
"0","  mutate(mesure=""Pauvreté monétaire"","
"0","         cas = fct_recode(cas,"
"0","                              ""Ensemble"" = ""TX_PAUVRETE"","
"0","                              ""Célibataire"" = ""TX_ISO_PAUVRETE"", "
"0","                              ""En couple""= ""TX_COU_PAUVRETE"" ),"
"0","         taux=taux*100) "
"0",""
"0","base2 <- srcv %>%"
"0","pivot_longer(cols = c(TX_PMS, TX_ISO_PMS, TX_COU_PMS), names_to = ""cas"", values_to = ""taux"") %>%"
"0","  select(modalite, cas, taux) %>%"
"0","  filter(modalite!=""Ensemble"")%>% "
"0","  mutate(mesure=""Privations matérielles et sociales"","
"0","         cas = fct_recode(cas,"
"0","                              ""Ensemble"" = ""TX_PMS"","
"0","                              ""Célibataire"" = ""TX_ISO_PMS"", "
"0","                              ""En couple""= ""TX_COU_PMS"" ),"
"0","         taux=taux*100)"
"0",""
"0","base<-rbind(base1,base2)"
"0",""
"0",""
"0",""
"0","base$modalite<-factor(base$modalite, levels=c(""moins de 0,3 smic"", ""[0,3 à 0,6["", ""[0,6 à 0,9["", ""[0,9 à 1,2["", ""[1,2 à 1,5["", ""[1,5 à 1,8["", ""1,8 smic et plus""))"
"0",""
"0",""
"0","graphG <- ggplot() +"
"0","  geom_col_interactive(data = base, aes(x = modalite, y = taux, fill = cas,"
"0","                             tooltip=paste(""Taux="",round(taux,1), ""%"")), "
"0","           position = position_dodge(width = 0.6),  # Position des barres"
"0","           width = 0.4) +  # Largeur des barres"
"0","  facet_wrap(~mesure)+"
"0","  theme_minimal() +"
"0","  #scale_fill_brewer(palette = ""Spectral"") +"
"0","  scale_y_continuous(limits = c(0, 51)) +"
"0","  #scale_x_discrete(expand = expansion(add = c(0.5, 0.5))) + "
"0","  labs(x = ""Revenu en tranche de Smic"","
"0","       y = ""Taux en %"") + "
"0","  theme("
"0","    legend.position = ""bottom"","
"0","    legend.title = element_blank(),"
"0","    legend.key.size = unit(0.2, units=""cm""),"
"0","    legend.text =  element_text(size = rel(0.6)),"
"0","    axis.title.x = element_text(size = rel(0.8)),  "
"0","    axis.title.y = element_text(size = rel(0.8)), "
"0","    axis.text.x = element_text(angle = 45, hjust = 1, size = rel(0.6)),"
"0","    plot.title = element_text(size=rel(0.6)),"
"0","    panel.border = element_rect(color = ""grey"", fill = NA, linewidth = 0.2),"
"0","    strip.text = element_text(size = rel(0.8),face=""bold"")"
"0","    )+"
"0","  guides(fill = guide_legend(nrow = 1))+"
"0","  labs(caption=""Source : ERFS ; calcul des auteurs"")+"
"0","  theme("
"0","   plot.caption = element_text(size = rel(0.5)) "
"0","  )"
"0","   "
"0",""
"0",""
"0",""
"0","igraphG<-girafe(ggobj = graphG)"
"0",""
"0",""
"0","if (is_html_output()) {"
"0","  igraphG"
"0","} else {"
"0","  print(graphG)"
"0","}"
"0",""
