"0","#| label: fig-gainsmarginaux"
"0","#| fig-cap: Gain marginaux effectifs pour une augmentation de 100 euros du revenu d'activit√©, selon la configuration familiale et le niveau de revenu initial"
"0",""
"0","castyp<-read.xlsx(file=""cas types gains marginaux.xlsx"",sheetName = ""synthese"") "
"0",""
"0","base<-castyp %>% "
"0","  mutate("
"0","    cas = case_when(isocou==""isol√©"" & nbenf==0 ~ ""isol√© sans enfant"","
"0","                    isocou==""couple"" & actconj==""Inactif"" & nbenf==2 ~ ""couple monoactif deux enfants"","
"0","                    isocou==""couple"" & actconj==""1 smic"" & nbenf==0 ~ ""couple biactif sans enfant"","
"0","                    isocou==""couple"" & actconj==""1 smic"" & nbenf==2 ~ ""couple biactif deux enfants"", "
"0","                    TRUE ~ ""autre"""
"0","  )) %>% "
"0","  filter(cas != ""autre"")  %>% "
"0","  mutate("
"0","    gainmarginal = RDISP"
"0","  ) %>% "
"0","  select(cas, activite, gainmarginal)"
"0",""
"0","base <- base  %>% "
"0","  mutate("
"0","    revenu=as.character(activite)"
"0","  )"
"0",""
"0","base$cas <- factor(base$cas, levels = c(""isol√© sans enfant"", ""couple monoactif deux enfants"", ""couple biactif sans enfant"", ""couple biactif deux enfants""))"
"0",""
"0",""
"0","graphG2 <- ggplot() +"
"0","  geom_col(data = base, aes(x = revenu, y = gainmarginal, fill = cas,"
"0","                            text = paste(""cas-type : "", cas, ""<br>Revenu: "", revenu, ""<br>Gain Marginal: "", round(gainmarginal, 0))), "
"0","           position = position_dodge(width = 0.6),  "
"0","           width = 0.4) +  "
"0","  theme_minimal() +"
"0","  scale_fill_brewer(palette = ""Spectral"") +"
"0","  scale_y_continuous(limits = c(0, 100)) +"
"0","  scale_x_discrete(expand = expansion(add = c(0.5, 0.5))) + "
"0","  labs(title = "" -Les taux marginaux d'imposition sont devenus plus √©lev√©s sur les revenus m√©dians (gains plus faibles)"","
"0","       x = ""Revenu individuel en parts de smic"","
"0","       y = ""Taux de gain marginal"") + "
"0","  theme("
"0","    legend.position = ""bottom"","
"0","    legend.title = element_blank(),"
"0","    axis.title.x = element_text(size = 10),  "
"0","    axis.title.y = element_text(size = 10),"
"0","    plot.title = element_text(size = 10, color = ""#FDAE61"", face = ""bold"")"
"0","    )+"
"0","  guides(fill = guide_legend(nrow = 2))   "
"2","Avis : [38;5;232mIgnoring unknown aesthetics: [32mtext[38;5;232m[39m"
"0","graphG2i <- ggplotly(graphG2, tooltip = ""text"")"
"0","graphG2i <- graphG2i %>%"
"0","  plotly::layout("
"0","     legend = list("
"0","      orientation = 'h',  "
"0","      x = 0.5,  "
"0","      xanchor = 'center',  "
"0","      y = -0.3,"
"0","      title = list(text = """"),"
"0","      itemwidth=60,"
"0","      traceorder='normal'"
"0","    )"
"0","  )"
"0",""
"0",""
"0","if (is_html_output()) {"
"0","  graphG2i"
"0","} else {"
"0","  print(graphG2)"
"0","}"
