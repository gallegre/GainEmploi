"0","#| label: fig-garde"
"0","#| fig-cap: Revenu disponible après coût de garde selon le revenu professionnel (isolé un enfant)"
"0",""
"0","castyp <- read_excel(""cas types smic jeune enfant.xlsx"",sheet = ""synthese"")"
"0",""
"0","#  Isolé 1 enfant"
"0","smic=1398.7"
"0","nbuc=1.3"
"0","seuilpm=1312*nbuc"
"0",""
"0","base<-castyp %>% "
"0","  filter(isocou==""isolé"" & nbenf==1) %>% "
"0","  mutate(typrev=case_when("
"0","    activite==0 ~ ""Sans revenu"","
"0","    activite==0.5 ~ ""Mi-temps au Smic"","
"0","    activite==1 & Salaire==smic ~ ""Temps plein au Smic"","
"0","    TRUE ~ ""Temps plein à 1,5 Smic"")"
"0","  ) %>% "
"0","  select(typrev,CGNET,Salaire,PF,PL,RSA,PA, RDISP_NET_CG)	"
"0",""
"0","basegr<-base %>% "
"0","  pivot_longer(cols=c(CGNET,Salaire,PF,PL,RSA,PA, RDISP_NET_CG)) "
"0",""
"0",""
"0","basegr$typrev<-factor(basegr$typrev,levels=c(""Sans revenu"",""Mi-temps au Smic"",""Temps plein au Smic"",""Temps plein à 1,5 Smic""))"
"0",""
"0","basegr$name<-factor(basegr$name, levels=rev(c(""CGNET"",""Salaire"", ""PF"", ""PL"", ""RSA"", ""PA"", ""RDISP_NET_CG"")))"
"0",""
"0","graphI1 <- ggplot(basegr %>% filter(name !='RDISP_NET_CG'), aes(fill = name,"
"0","                                                       y = value, x = typrev)) + "
"0","  scale_fill_manual("
"0","    values = c(""CGNET""=""darkred"",""Salaire""= ""#482677FF"", ""PF"" = ""#39568CFF"", ""PL"" = ""#238A8DFF"", "
"0","               ""RSA"" = ""#55C667FF"", ""PA"" = ""#95D840FF""),"
"0","    labels = c(""CGNET""=""Coût net de la garde"","
"0","               ""PA"" = ""Prime d'activité"","
"0","               ""RSA"" = ""Revenu de solidarité active"","
"0","               ""PF"" = ""Prestations familiales"","
"0","               ""PL"" = ""Prestations logement"","
"0","               ""Salaire"" = ""Salaire"" "
"0","    ),"
"0","    # guide = guide_legend(reverse = TRUE)  "
"0","  ) +"
"0","  geom_bar("
"0","    position = ""stack"", "
"0","    stat = ""identity"", "
"0","    aes()"
"0","  ) +"
"0","  geom_point("
"0","    data = basegr %>% filter(name == 'RDISP_NET_CG'), "
"0","    aes("
"0","      x = typrev, y = round(value, 2), "
"0","      colour = ""Revenu disponible net du coût de la garde"", "
"0","    ), "
"0","    size = 3"
"0","  ) +"
"0","#      geom_hline("
"0","#  aes(yintercept = (4/6)*seuilpm, linetype = ""Seuil de grande pauvreté monétaire""),"
"0","#              color = ""grey40"",linewidth = 0.5)+"
"0","#    geom_hline(aes(yintercept = seuilpm,linetype = ""Seuil de pauvreté monétaire""),"
"0","#    color = ""grey40"",linewidth = 0.5)+"
"0","  scale_linetype_manual(name = ""Références"", values = c(""Seuil de pauvreté monétaire"" = ""solid"", ""Seuil de grande pauvreté monétaire"" = ""dashed""),"
"0","                        limits = c(""Seuil de pauvreté monétaire"", ""Seuil de grande pauvreté monétaire""))+"
"0","  labs(title = ""Famille monoparentale\n avec un enfant"")+"
"0","    guides("
"0","    fill = guide_legend(order = 1),  # La légende des couleurs en premier"
"0","    colour=guide_legend(order = 2),"
"0","    linetype = guide_legend(order = 3) # La légende des lignes en dernier"
"0","  ) +"
"0","  theme("
"0","    panel.background = element_rect(fill = ""white""), "
"0","    plot.background = element_rect(fill = ""white""),"
"0","    legend.position = ""none"","
"0","    axis.title.x = element_blank(),"
"0","    axis.title.y = element_blank(),"
"0","    legend.text = element_text(size = rel(0.7)),"
"0","    legend.title = element_blank(),"
"0","    plot.title = element_text(size = rel(0.8), hjust = 0.7),"
"0","    plot.caption = element_text(size = rel(0.5)),"
"0","    plot.margin =  margin(t = 20, r = 10, b = 20, l = 10),"
"0","    axis.ticks.y = element_blank(),"
"0","    axis.line = element_line(color = ""black"", linewidth = 0.2, linetype = ""solid""),"
"0","    axis.text.x = element_text(size = rel(0.9), angle = 40, hjust = 1,vjust = 1)"
"0","  ) +"
"0","  theme(panel.border = element_blank())"
"0",""
"0","base<-castyp %>% "
"0","  filter(isocou==""couple"" & actconj==""1 smic"" & nbenf==1) %>% "
"0","  mutate(typrev=case_when("
"0","    activite==0 ~ ""Sans revenu"","
"0","    activite==0.5 ~ ""Mi-temps au Smic"","
"0","    activite==1 & Salaire==smic ~ ""Temps plein au Smic"","
"0","    TRUE ~ ""Temps plein à 1,5 Smic"")"
"0","  ) %>% "
"0","  select(typrev,CGNET,Ract_conj,Salaire,PF,PL,RSA,PA, RDISP_NET_CG)	"
"0",""
"0","basegr<-base %>% "
"0","  pivot_longer(cols=c(CGNET,Ract_conj,Salaire,PF,PL,RSA,PA, RDISP_NET_CG)) "
"0",""
"0",""
"0","basegr$typrev<-factor(basegr$typrev,levels=c(""Sans revenu"",""Mi-temps au Smic"",""Temps plein au Smic"",""Temps plein à 1,5 Smic""))"
"0",""
"0","basegr$name<-factor(basegr$name, levels=rev(c(""CGNET"",""Ract_conj"",""Salaire"", ""PF"", ""PL"", ""RSA"", ""PA"", ""RDISP_NET_CG"")))"
"0",""
"0","graphC1_S <- ggplot(basegr %>% filter(name !='RDISP_NET_CG'), aes(fill = name,"
"0","                                                                y = value, x = typrev)) + "
"0","  scale_fill_manual("
"0","    values = c(""CGNET""=""darkred"",'Ract_conj' = 'grey50',""Salaire""= ""#482677FF"", ""PF"" = ""#39568CFF"", ""PL"" = ""#238A8DFF"", "
"0","               ""RSA"" = ""#55C667FF"", ""PA"" = ""#95D840FF""),"
"0","    labels = c(""CGNET""=""Coût net de la garde"","
"0","               ""PA"" = ""Prime d'activité"","
"0","               ""RSA"" = ""RSA"","
"0","               ""PF"" = ""Prestations familiales"","
"0","               ""PL"" = ""Prestations logement"","
"0","               ""Salaire"" = ""Salaire"" ,"
"0","               ""Ract_conj""=""Salaire du conjoint"""
"0","    ),"
"0","     ) +"
"0","  geom_bar("
"0","    position = ""stack"", "
"0","    stat = ""identity"", "
"0","    aes()"
"0","  ) +"
"0","  geom_point("
"0","    data = basegr %>% filter(name == 'RDISP_NET_CG'), "
"0","    aes("
"0","      x = typrev, y = round(value, 2), "
"0","      colour = ""Revenu disponible net \n du coût de la garde"", "
"0","    ), "
"0","    size = 3"
"0","  ) +"
"0","#      geom_hline("
"0","#  aes(yintercept = (4/6)*seuilpm, linetype = ""Seuil de grande pauvreté monétaire""),"
"0","#              color = ""grey40"",linewidth = 0.5)+"
"0","#    geom_hline(aes(yintercept = seuilpm,linetype = ""Seuil de pauvreté monétaire""),"
"0","#    color = ""grey40"",linewidth = 0.5)+"
"0","  scale_linetype_manual(name = ""Références"", values = c(""Seuil de pauvreté monétaire"" = ""solid"", ""Seuil de grande pauvreté monétaire"" = ""dashed""),"
"0","                        limits = c(""Seuil de pauvreté monétaire"", ""Seuil de grande pauvreté monétaire""))+"
"0","  labs(title = ""Couple avec un enfant"")+"
"0","    guides("
"0","    fill = guide_legend(order = 1),  # La légende des couleurs en premier"
"0","    colour=guide_legend(order = 2),"
"0","    linetype = guide_legend(order = 3) # La légende des lignes en dernier"
"0","  ) +"
"0","  theme("
"0","    panel.background = element_rect(fill = ""white""), "
"0","    plot.background = element_rect(fill = ""white""),"
"0","    legend.position =  ""right"","
"0","    axis.title.x = element_blank(),"
"0","    axis.title.y = element_blank(),"
"0","    legend.text = element_text(size = rel(0.7)),"
"0","    legend.title = element_blank(),"
"0","    plot.title = element_text(size = rel(0.8), hjust = 0.7),"
"0","    plot.caption = element_text(size = rel(0.5)),"
"0","    plot.margin =  margin(t = 20, r = 10, b = 20, l = 10),"
"0","    axis.ticks.y = element_blank(),"
"0","    axis.line = element_line(color = ""black"", linewidth = 0.2, linetype = ""solid""),"
"0","    axis.text.x = element_text(size = rel(0.9), angle = 40, hjust = 1,vjust = 1)"
"0","  ) +"
"0","  #labs(title=""Couple 1 enfant - conjoint au smic"",size=5)+"
"0","  #scale_y_continuous(expand = c(0, 0), limits = c(0, 4000), breaks = seq(0, 4000, by = 500)) + "
"0","  theme(panel.border = element_blank())"
"0",""
"0","graph_cdg<-graphI1+graphC1_S"
