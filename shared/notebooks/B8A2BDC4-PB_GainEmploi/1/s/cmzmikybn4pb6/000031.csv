"0","#| label: fig-ndvminimum"
"0","#| fig-cap: Niveau de vie (en euros par uc) du revenu d'assistance et des allocations logement selon la configuration familiale, pour un foyer sans revenu primaire "
"0"," "
"0","castyp<-read_excel(""cas types smic.xlsx"",sheet = ""synthese"") "
"0","seuilpm=1312"
"0","seuil40=seuilpm*4/6"
"0",""
"0","base<-castyp %>% "
"0","  filter(activite==0, Ract_conj==0) %>% "
"0","  mutate("
"0","       enf=case_when(nbenf==0 ~ ""Sans enfant"","
"0","                  nbenf==1 ~ ""1 enfant"","
"0","                  nbenf==2 ~ ""2 enfants"","
"0","                  TRUE ~ ""3 enfants"")"
"0","    ) %>% "
"0","  select(isocou, enf, NVIE)"
"0",""
"0","base$enf <- factor(base$enf, levels = c(""Sans enfant"", ""1 enfant"", ""2 enfants"",""3 enfants"")) "
"0",""
"0","graph5 <- ggplot(base, aes(x = isocou, y = NVIE, fill = enf)) + "
"0","  geom_bar_interactive(stat = ""identity"", position = ""dodge"", "
"0","    aes(y=NVIE, fill=enf,tooltip=paste(""niveau de vie :"",round(NVIE,0), ""euros""))"
"0","  ) + "
"0","  scale_fill_economist() +  "
"0","  theme_minimal() +"
"0","  scale_y_continuous(limits = c(0, 1500)) +  "
"0","    geom_hline("
"0","  aes(yintercept = (4/6)*seuilpm, linetype = ""Seuil de grande pauvreté monétaire (40 %)""),"
"0","              color = ""grey40"",linewidth = 0.5)+"
"0","    geom_hline(aes(yintercept = seuilpm,linetype = ""Seuil de pauvreté monétaire (60 %)""),"
"0","    color = ""grey40"",linewidth = 0.5)+"
"0","  scale_linetype_manual(name = ""Références"", values = c(""Seuil de pauvreté monétaire (60 %)"" = ""solid"", ""Seuil de grande pauvreté monétaire (40 %)"" = ""dashed""),"
"0","                        limits = c(""Seuil de pauvreté monétaire (60 %)"", ""Seuil de grande pauvreté monétaire (40 %)""))+"
"0","    guides("
"0","    fill = guide_legend(order = 1),  # La légende des couleurs en premier"
"0","    linetype = guide_legend(order = 2,nrow=2) # La légende des lignes en dernier,"
"0","  ) +"
"0","  theme("
"0","    axis.title.x = element_blank(),"
"0","    axis.title.y = element_blank(),"
"0","    legend.title = element_blank(),"
"0","    legend.position=""bottom"","
"0","    legend.box = ""vertical"","
"0","    legend.text=element_text(rel=0.6),"
"0","    legend.key.size = unit(0.3, units=""cm""),"
"0","    legend.spacing.y = unit(0.001, ""cm""),"
"0","    plot.margin = margin(t = 20, r = 10, b = 20, l = 10),"
"0","    axis.line = element_line(color = ""black"", linewidth = 0.2, linetype = ""solid""),"
"0","    axis.text.x = element_text(size = rel(0.9), angle = 00, hjust = 1, vjust = 1)"
"0","  )"
"0",""
"0","igraph5<-girafe(ggobj = graph5)"
"0",""
"0","if (is_html_output()) {"
"0","  igraph5"
"0","} else {"
"0","  print(graph5)"
"0","}"
"0",""
