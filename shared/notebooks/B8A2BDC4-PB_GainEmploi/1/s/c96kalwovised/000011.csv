"0","#| label: fig-C2A2ECCH"
"0","#| fig-cap: Revenu disponible d'un couple avec deux enfants selon le revenu professionnel, conjoint au chômage (ARE=1 smic)"
"0",""
"0","castyp<-read.xlsx(file=""cas types smic.xlsx"",sheetName = ""synthese"") "
"0",""
"0","smic=1398.7"
"0",""
"0","base<-castyp %>% "
"0","  filter(isocou==""couple"" & nbenf==2 & actconj==""Chômeur"") %>% "
"0","  mutate(typrev=case_when("
"0","    activite==0 ~ ""Sans revenu"","
"0","    activite==0.5 ~ ""Avec un mi-temps \n au Smic"","
"0","    activite==1 & Salaire==smic ~ ""Avec un temps plein\n au Smic"","
"0","    TRUE ~ ""Avec un temps plein \n à 1,5 Smic"")"
"0","  ) %>% "
"0","  select(typrev,Salaire,Ract_conj,PF,PL,RSA,PA,	IR,	RDISP)	"
"0",""
"0","basegr<-base %>% "
"0","  pivot_longer(cols=c(Salaire, Ract_conj, PF,PL,RSA,PA,RDISP)) "
"0",""
"0",""
"0","seuilpm=1309*2.1"
"0",""
"0",""
"0","basegr$typrev<-factor(basegr$typrev,levels=c(""Sans revenu"",""Avec un mi-temps \n au Smic"",""Avec un temps plein\n au Smic"",""Avec un temps plein \n à 1,5 Smic""))"
"0",""
"0","basegr1 <- basegr %>% filter(name != 'RDISP')"
"0","basegr2 <- basegr %>% filter(name == 'RDISP')"
"0",""
"0",""
"0","basegr1 <- basegr1 %>% mutate(name = factor(name, levels = rev(c(""Ract_conj"", ""Salaire"", ""PF"", ""PL"", ""RSA"", ""PA"")) ))"
"0",""
"0","basegr1 <- basegr1  %>% mutate(name = recode(name, ""Ract_conj"" = ""ARE conjoint""))"
"0",""
"0","# cas couple avec conjoint au smic #"
"0",""
"0","graph3b <- ggplot(basegr1, aes(fill = name, y = value, x = typrev)) + "
"0","  scale_fill_manual("
"0","    labels=c(""ARE conjoint"" = ""ARE conjoint"","
"0","             ""Salaire""=""Salaire"","
"0","             ""PF"" = ""Prestations familiales"","
"0","             ""PL"" = ""Prestations logement"","
"0","             ""RSA""=""RSA"","
"0","             ""PA"" = ""Prime d'activité"""
"0","             ),"
"0","    values = c('ARE conjoint' = '#440154FF',"
"0","               'Salaire' = '#482677FF',"
"0","               'PF' = '#39568CFF',"
"0","               'PL' = '#238A8DFF',"
"0","               'RSA' = '#55C667FF', "
"0","               'PA' = '#95D840FF'"
"0","               ))  +"
"0","   geom_bar_interactive("
"0","    position = ""stack"", "
"0","    stat = ""identity"", "
"0","    aes(y=value, fill=name,tooltip=paste(name,"":"",round(value,0), ""euros""))"
"0","  ) +"
"0","  geom_point_interactive("
"0","    data = basegr %>% filter(name == 'RDISP'), "
"0","    aes("
"0","      x = typrev, y = round(value, 2), "
"0","      colour = ""Revenu disponible"", "
"0","      tooltip=paste(""Revenu disponible :"",round(value,0), ""euros"")), "
"0","    size = 3"
"0","  ) +"
"0","  scale_color_manual("
"0","    values = c(""Revenu disponible"" = ""orange"")  "
"0","  ) +"
"0","      geom_hline("
"0","  aes(yintercept = (4/6)*seuilpm, linetype = ""Seuil de grande pauvreté monétaire""),"
"0","              color = ""grey40"",linewidth = 0.5)+"
"0","    geom_hline(aes(yintercept = seuilpm,linetype = ""Seuil de pauvreté monétaire""),"
"0","    color = ""grey40"",linewidth = 0.5)+"
"0","  scale_linetype_manual(name = ""Références"", values = c(""Seuil de pauvreté monétaire"" = ""solid"", ""Seuil de grande pauvreté monétaire"" = ""dashed""),"
"0","                        limits = c(""Seuil de pauvreté monétaire"", ""Seuil de grande pauvreté monétaire""))+"
"0","    guides("
"0","    fill = guide_legend(order = 1),  # La légende des couleurs en premier"
"0","    colour=guide_legend(order = 2),"
"0","    linetype = guide_legend(order = 3) # La légende des lignes en dernier"
"0","  ) +"
"0","  theme("
"0","    panel.background = element_rect(fill = ""white""), "
"0","    plot.background = element_rect(fill = ""white""),"
"0","    legend.position = ""right"","
"0","    axis.title.x = element_blank(),"
"0","    axis.title.y = element_blank(),"
"0","    legend.text = element_text(size = rel(0.7)),"
"0","    legend.title = element_blank(),"
"0","    plot.title = element_text(size = rel(0.8), hjust = 0.7),"
"0","    plot.caption = element_text(size = rel(0.5)),"
"0","    plot.margin = margin(t = 20, r = 10, b = 20, l = 10),"
"0","    axis.ticks.y = element_blank(),"
"0","    axis.line = element_line(color = ""black"", linewidth = 0.2, linetype = ""solid""),"
"0","    axis.text.x = element_text(size = rel(0.9), angle = 40, hjust = 1, vjust = 1),"
"0","    panel.border = element_blank()"
"0","  ) +"
"0","  scale_y_continuous(expand = c(0, 0), limits = c(0, 4500), breaks = seq(0, 4500, by = 500)) "
"0",""
"0",""
"0","igraph3b <- girafe(ggobj = graph3b)"
"0",""
"0","if (is_html_output()) {"
"0","  igraph3b"
"0","} else {"
"0","  print(graph3b)"
"0","}"
"0",""
