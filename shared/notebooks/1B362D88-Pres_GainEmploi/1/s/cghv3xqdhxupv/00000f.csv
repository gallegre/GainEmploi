"0",""
"0","castyp<-read.xlsx(file=""cas types smic.xlsx"",sheetName = ""synthese"") "
"0",""
"0","base<-castyp %>% "
"0","  mutate("
"0","    casconj=case_when(isocou==""isol√©"" ~ ""Sans conjoint"","
"0","                  isocou==""couple"" & actconj==""Inactif"" ~ ""Conjoint sans revenu"","
"0","                  isocou==""couple"" & actconj==""Ch√¥meur"" ~ ""Conjoint ch√¥meur"","
"0","                  isocou==""couple"" & actconj==""1 smic"" ~ ""Conjoint salari√© au smic"","
"0","                  TRUE ~ ""Conjoint salari√© √† 1,5 smic""),"
"0","    enf=case_when(nbenf==0 ~ ""0 enfant"","
"0","                  nbenf==1 ~ ""1 enfant"","
"0","                  nbenf==2 ~ ""2 enfants"","
"0","                  TRUE ~ ""3 enfants""),"
"0","    cas=paste0(casconj,"" - "",enf),"
"0","    act=case_when(activite<1 ~ 100*activite,"
"0","                  Salaire==smic ~ 100,"
"0","                  TRUE ~ 150)"
"0","    ) %>% "
"0","  select(casconj,enf,cas,Salaire,act,RDISP) "
"0",""
"0","basegr<-base %>% "
"0","  pivot_wider(names_from=act, values_from = c(Salaire, RDISP)) %>% "
"0","  mutate("
"0","    var_rp_50=Salaire_50-Salaire_0,"
"0","    var_rd_50=RDISP_50-RDISP_0,"
"0","    TGM_50=100*(var_rd_50/var_rp_50),"
"0","    var_rp_100=Salaire_100-Salaire_0,"
"0","    var_rd_100=RDISP_100-RDISP_0,"
"0","    TGM_100=100*(var_rd_100/var_rp_100),"
"0","    var_rp_150=Salaire_150-Salaire_0,"
"0","    var_rd_150=RDISP_150-RDISP_0,"
"0","    TGM_150=100*(var_rd_150/var_rp_150),"
"0"," ) %>% "
"0","  select(casconj,enf,cas,TGM_50,TGM_100,TGM_150)"
"0",""
"0","basegr$enf <- factor(basegr$enf, levels=c(""0 enfant"",""1 enfant"",""2 enfants"",""3 enfants""))"
"0",""
"0",""
"0","basegr$casconj <- factor(basegr$casconj,levels=c(""Sans conjoint"",""Conjoint sans revenu"","
"0","                                               ""Conjoint ch√¥meur"",""Conjoint salari√© au smic"","
"0","                                               ""Conjoint salari√© √† 1,5 smic""))"
"0",""
"0",""
"0",""
"0",""
"0","graph4 <- ggplot() +"
"0","  geom_point(data=basegr, aes(x = casconj, y = TGM_100, colour = enf, "
"0","                              text = paste0("
"0","        ""<span style='font-size:14px'>Taux effectif de gain √† l'emploi: "", "
"0","        number(TGM_100, accuracy = 1),""%"", "
"0","        ""</span>"""
"0","      )"
"0","    ),"
"0","    size = 3"
"0","  ) +  "
"0","  theme_minimal() +"
"0","  scale_y_continuous(limits = c(25, 100)) + "
"0","  labs(title = ""Les taux de gains du passage √† plein-temps sont plus h√©t√®rog√®nes en pr√©sence d'un conjoint"",colour="""")+"
"0","  theme("
"0","    axis.title.x = element_blank(),"
"0","    axis.title.y = element_blank(),"
"0","    legend.title = element_blank(),"
"0","    legend.text = element_text(size=rel(1.2)), "
"0","    plot.margin = margin(t = 20, r = 10, b = 20, l = 10),"
"0","    axis.line = element_line(color = ""black"", linewidth = 0.2, linetype = ""solid""),"
"0","    axis.text.x = element_text(size = rel(1.2), angle = 40, hjust = 1, vjust = 1),"
"0","    plot.title = element_text(size = rel(1.2), color=""#5E4FA2"")"
"0","  )"
"2","Avis : [38;5;232mIgnoring unknown aesthetics: [32mtext[38;5;232m[39m"
"0","igraph4<-ggplotly(graph4, tooltip=""text"","
"0","      width = 900,   # largeur en pixels (√† ajuster)"
"0","    height = 600,  # hauteur en pixels (√† ajuster)"
"0","     legend = list("
"0","      orientation = 'v',  "
"0","      x = 1,  "
"0","      xanchor = 'left',  "
"0","      y = 0.5,"
"0","      title = list(text = """"),"
"0","      itemwidth=60,"
"0","      traceorder='normal'"
"0","    )"
"0","                   )"
"0","igraph4"
