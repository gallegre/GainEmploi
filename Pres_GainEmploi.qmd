---
title: "La reprise d'emploi est-elle toujours rémunératrice?"
subtitle: "Guillaume Allègre & Muriel Pucci <br> Séminaire IRES-OFCE"
author-footer: "Allègre & Pucci"
date: 2025-06-13
format: 
  pres-revealjs:
    toc-depth: 1
    embed-resources: true
    fig-cap-location: top
---

```{r, include=FALSE}
ofce::init_qmd()

library(knitr) 
library(tidyverse) 
library(ofce) 
library(lubridate) 
library(knitr) 
library(scales) 
library(dplyr) 
library(tibble) 
library(readxl) 
library(skimr) 
library(tidyr) 
library(rsdmx) 
library(ggthemes) 
library(haven)
library(glue)
library(readr)
library(reshape2)
library(MetricsWeighted)
library(questionr)
library(xlsx)
library(patchwork)
library(ggplot2)
library(ggrepel)
library(blorr)
library(plotly)
library(ggiraph)
library(sf) 
library(RColorBrewer)
library(viridis)
library(ggsci)
library(quarto)
library(patchwork)
```

# Propos introductif

## Pourquoi cette question aujourd'hui ? {.smaller}

La réponse à une commande d'Alternatives Economiques :

![](Images/AE_Allegre_Pucci.png){width="513"}

<https://www.alternatives-economiques.fr/non-on-ne-gagne-plus-allocations-quen-travaillant/00112653>

## Une question récurrente

Rapport Hirsch ("Au possible, nous sommes tenus", 2005) :

![](Images/Rapport-Hirsch.PNG){fig-align="center"}

Proposition d'ACR (Roger Godino : Pour une réforme du RMI, 1999), ici en entretien (2003) :

![](Images/Godino_ACR.png){fig-align="center" width="672"}

## Les objectifs de la stratégie nationale de prévention et de lutte contre la pauvreté (SNPLP)

On peut dégager **trois objectifs de la SNPLP** (en réalité, les mêmes que dans le rapport Hirsch) :

-   Faire en sorte que le travail paye et de la même façon dans tous les cas

-   Faire en sorte que le travaille permette d'échapper à la pauvreté

-   Garantir un soutien financier aux ménages modestes

    en lien avec le préambule de la constitution : "[Tout être humain qui, en raison de son âge, de son état physique ou mental, de la situation économique, se trouve dans l'incapacité de travailler a le droit d'obtenir de la collectivité des moyens convenables d'existence]{style="color : red"}"

**-\> Question : le système social et fiscal atteint-il ces objectifs ?**

# 1. La reprise d'emploi est toujours rémunératrice mais de façon hétérogène

## L'emploi est rémunérateur à chaque niveau (cas de la personne seule) {.smaller}

```{r}

castyp<-read.xlsx(file="cas types smic.xlsx",sheetName = "synthese") 

smic=1398.7

base<-castyp %>% 
  filter(isocou=="isolé" & nbenf==0) %>% 
  mutate(typrev=case_when(
    activite==0 ~ "Sans revenu",
    activite==0.5 ~ "Avec un mi-temps \n au Smic",
    activite==1 & Salaire==smic ~ "Avec un temps plein\n au Smic",
    TRUE ~ "Avec un temps plein \n à 1,5 Smic")
  ) %>% 
  mutate(
    seuil60 = 1309
  ) %>% 
  select(typrev,Salaire,PF,PL,RSA,PA, RDISP, seuil60)	

basegr<-base %>% 
  pivot_longer(cols=c(Salaire,PF,PL,RSA,PA, RDISP)) 

seuilpm=1309
RDmin=min(base$RDISP)


basegr$typrev<-factor(basegr$typrev,levels=c("Sans revenu","Avec un mi-temps \n au Smic","Avec un temps plein\n au Smic","Avec un temps plein \n à 1,5 Smic"))

basegr$name<-factor(basegr$name, levels=rev(c("Salaire", "PF", "PL", "RSA", "PA", "RDISP")))

labels_name <- c(
  "Salaire" = "Salaire",
  "PF" = "Prestations familiales",
  "PL" = "Prestations logement",
  "RSA" = "Revenu de solidarité active",
  "PA" = "Prime d'activité",
  "RDISP" = "Revenu disponible"
)

basegr <- basegr %>%
  mutate(label = labels_name[as.character(name)],
         label = ifelse(is.na(label), as.character(name), label))  


graph <- ggplot(basegr %>% filter(name !='RDISP'), aes(fill = name,
  y = value, x = typrev)) + 
  scale_fill_manual(
    values = c("Salaire" = "#482677FF", "PF" = "#39568CFF", "PL" = "#238A8DFF", 
               "RSA" = "#55C667FF", "PA" = "#95D840FF"),
  labels = c("PA" = "Prime d'activité",
             "RSA" = "Revenu de solidarité active",
             "PF" = "Prestations familiales",
             "PL" = "Prestations logement",
             "Salaire" = "Salaire"),
    guide = guide_legend(reverse = TRUE)  
  ) +
   geom_bar_interactive(
    position = "stack", 
    stat = "identity", 
    aes(y=value, fill=name,tooltip=paste(label, ":", round(value,0),"euros"))
  ) +
    geom_point_interactive(
    data = basegr %>% filter(name == 'RDISP'), 
    aes(
      x = typrev, y = round(value, 2), 
      colour = "Revenu disponible", 
      tooltip=paste("Revenu disponible :",round(value,0), "euros, soit +",round(value-RDmin,0))), 
    size = 3
  ) +
    guides(
    fill = guide_legend(order = 2),  # La légende des couleurs en premier
    colour=guide_legend(order = 1),
    ) +
  theme(
    panel.background = element_rect(fill = "white"), 
    plot.background = element_rect(fill = "white"),
    legend.position =  "right",
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.text = element_text(size = rel(1.1)),
    legend.title = element_blank(),
    plot.title = element_text(size = rel(1.1), hjust = 0.7),
    plot.caption = element_text(size = rel(1.1)),
    plot.margin =  margin(t = 20, r = 10, b = 40, l = 10),
    axis.ticks.y = element_blank(),
    axis.line = element_line(color = "black", linewidth = 0.2, linetype = "solid"),
    axis.text.x = element_text(size = rel(1.1), angle = 40, hjust = 1,vjust = 1)
  ) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 2250), breaks = seq(0, 2250, by = 250,)) + 
  theme(panel.border = element_blank())

igraph <- girafe(
  ggobj = graph,
  options = list(
    opts_tooltip(
      css = "
        background-color: red ;
        color: white;
        padding: 6px;
        border-radius: 4px;
        font-size: 20px;
      "
    )
  )
)

igraph


```

## (cas du couple avec 2 enfants, conjoint inactif) {.smaller}

```{r}

castyp<-read.xlsx(file="cas types smic.xlsx",sheetName = "synthese") 

smic=1398.7

base<-castyp %>% 
  filter(isocou=="couple" & nbenf==2 & actconj=="Inactif") %>% 
  mutate(typrev=case_when(
    activite==0 ~ "Sans revenu",
    activite==0.5 ~ "Avec un mi-temps \n au Smic",
    activite==1 & Salaire==smic ~ "Avec un temps plein\n au Smic",
    TRUE ~ "Avec un temps plein \n à 1,5 Smic")
  ) %>% 
  select(typrev,Salaire,Ract_conj,PF,PL,RSA,PA,	RDISP)	

basegr<-base %>% 
  pivot_longer(cols=c(Ract_conj, Salaire,RSA,PA, PL,PF, RDISP)) 


seuilpm=1309*2.1
RDmin=min(base$RDISP)

basegr$typrev<-factor(basegr$typrev,levels=c("Sans revenu","Avec un mi-temps \n au Smic","Avec un temps plein\n au Smic","Avec un temps plein \n à 1,5 Smic"))

basegr1 <- basegr %>% filter(name != 'RDISP')
basegr2 <- basegr %>% filter(name == 'RDISP')

basegr1 <- basegr1 %>% mutate(name = factor(name, levels = rev(c("Ract_conj", "Salaire", "PF", "PL", "RSA", "PA")) ))


# cas couple avec conjoint au smic #

graph3a <- ggplot(basegr1, aes(fill = name, y = value, x = typrev)) + 
  scale_fill_manual(
    labels=c("Ract_conj" = "Salaire conjoint",
             "Salaire"="Salaire",
             "PF" = "Prestations familiales",
             "PL" = "Prestations logement",
             "RSA"="RSA",
             "PA" = "Prime d'activité"
             ),
    values = c('Ract_conj' = '#440154FF',
               'Salaire' = '#482677FF',
               'PF' = '#39568CFF',
               'PL' = '#238A8DFF',
               'RSA' = '#55C667FF', 
               'PA' = '#95D840FF'
               ))  +
   geom_bar_interactive(
    position = "stack", 
    stat = "identity", 
    aes(y=value, fill=name,tooltip=paste(name,":", round(value,0), "euros"))
  ) +
  geom_point_interactive(
    data = basegr %>% filter(name == 'RDISP'), 
    aes(
      x = typrev, y = round(value, 2), 
      colour = "Revenu disponible", 
      tooltip=paste("Revenu disponible :",round(value,0), "euros, soit +",round(value-RDmin,0))), 
    size = 3
  ) +
  scale_color_manual(
    values = c("Revenu disponible" = "orange")  
  ) +
    guides(
    fill = guide_legend(order = 2),  # La légende des couleurs en premier
    colour=guide_legend(order = 1),
    
  ) +
  theme(
    panel.background = element_rect(fill = "white"), 
    plot.background = element_rect(fill = "white"),
    legend.position = "right",
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.text = element_text(size = rel(1.1)),
    legend.title = element_blank(),
    plot.title = element_text(size = rel(0.8), hjust = 0.7),
    plot.caption = element_text(size = rel(0.5)),
    plot.margin = margin(t = 20, r = 10, b = 40, l = 10),
    axis.ticks.y = element_blank(),
    axis.line = element_line(color = "black", linewidth = 0.2, linetype = "solid"),
    axis.text.x = element_text(size = rel(1.1), angle = 40, hjust = 1, vjust = 1)
  ) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 4500), breaks = seq(0, 4500, by = 500)) + 
  theme(panel.border = element_blank())


igraph3a <- girafe(
  ggobj = graph3a,
  options = list(
    opts_tooltip(
      css = "
        background-color: red ;
        color: white;
        padding: 6px;
        border-radius: 4px;
        font-size: 20px;
      "
    )
  )
)

igraph3a

```

## (cas du couple avec 2 enfants, conjoint au smic) {.smaller}

```{r}

castyp<-read.xlsx(file="cas types smic.xlsx",sheetName = "synthese") 

smic=1398.7

base<-castyp %>% 
  filter(isocou=="couple" & nbenf==2 & actconj=="1 smic") %>% 
  mutate(typrev=case_when(
    activite==0 ~ "Sans revenu",
    activite==0.5 ~ "Avec un mi-temps \n au Smic",
    activite==1 & Salaire==smic ~ "Avec un temps plein\n au Smic",
    TRUE ~ "Avec un temps plein \n à 1,5 Smic")
  ) %>% 
  select(typrev,Salaire,Ract_conj,PF,PL,RSA,PA,	RDISP)	

basegr<-base %>% 
  pivot_longer(cols=c(Ract_conj, Salaire,RSA,PA, PL,PF, RDISP)) 


seuilpm=1309*2.1
RDmin=min(base$RDISP)

basegr$typrev<-factor(basegr$typrev,levels=c("Sans revenu","Avec un mi-temps \n au Smic","Avec un temps plein\n au Smic","Avec un temps plein \n à 1,5 Smic"))

basegr1 <- basegr %>% filter(name != 'RDISP')
basegr2 <- basegr %>% filter(name == 'RDISP')

basegr1 <- basegr1 %>% mutate(name = factor(name, levels = rev(c("Ract_conj", "Salaire", "PF", "PL", "RSA", "PA")) ))


# cas couple avec conjoint au smic #

graph3b <- ggplot(basegr1, aes(fill = name, y = value, x = typrev)) + 
  scale_fill_manual(
    labels=c("Ract_conj" = "Salaire conjoint",
             "Salaire"="Salaire",
             "PF" = "Prestations familiales",
             "PL" = "Prestations logement",
             "RSA"="RSA",
             "PA" = "Prime d'activité"
             ),
    values = c('Ract_conj' = '#440154FF',
               'Salaire' = '#482677FF',
               'PF' = '#39568CFF',
               'PL' = '#238A8DFF',
               'RSA' = '#55C667FF', 
               'PA' = '#95D840FF'
               ))  +
   geom_bar_interactive(
    position = "stack", 
    stat = "identity", 
    aes(y=value, fill=name,tooltip=paste(name,":", round(value,0), "euros"))
  ) +
  geom_point_interactive(
    data = basegr %>% filter(name == 'RDISP'), 
    aes(
      x = typrev, y = round(value, 2), 
      colour = "Revenu disponible", 
      tooltip=paste("Revenu disponible :",round(value,0), "euros, soit +",round(value-RDmin,0))), 
    size = 3
  ) +
  scale_color_manual(
    values = c("Revenu disponible" = "orange")  
  ) +
    guides(
    fill = guide_legend(order = 2),  # La légende des couleurs en premier
    colour=guide_legend(order = 1),
    
  ) +
  theme(
    panel.background = element_rect(fill = "white"), 
    plot.background = element_rect(fill = "white"),
    legend.position = "right",
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.text = element_text(size = rel(1.1)),
    legend.title = element_blank(),
    plot.title = element_text(size = rel(0.8), hjust = 0.7),
    plot.caption = element_text(size = rel(0.5)),
    plot.margin = margin(t = 20, r = 10, b = 40, l = 10),
    axis.ticks.y = element_blank(),
    axis.line = element_line(color = "black", linewidth = 0.2, linetype = "solid"),
    axis.text.x = element_text(size = rel(1.1), angle = 40, hjust = 1, vjust = 1)
  ) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 4500), breaks = seq(0, 4500, by = 500)) + 
  theme(panel.border = element_blank())


igraph3b <- girafe(
  ggobj = graph3b,
  options = list(
    opts_tooltip(
      css = "
        background-color: red ;
        color: white;
        padding: 6px;
        border-radius: 4px;
        font-size: 20px;
      "
    )
  )
)

igraph3b

```

## 

## La nouvelle courbe des gains marginaux à l’emploi

```{r}


castyp<-read.xlsx(file="cas types gains marginaux.xlsx",sheetName = "synthese") 

base<-castyp %>% 
  mutate(
    cas = case_when(isocou=="isolé" & nbenf==0 ~ "isolé sans enfant",
                    isocou=="couple" & actconj=="Inactif" & nbenf==2 ~ "couple monoactif deux enfants",
                    isocou=="couple" & actconj=="1 smic" & nbenf==0 ~ "couple biactif sans enfant",
                    isocou=="couple" & actconj=="1 smic" & nbenf==2 ~ "couple biactif deux enfants", 
                    TRUE ~ "autre"
  )) %>% 
  filter(cas != "autre")  %>% 
  mutate(
    gainmarginal = RDISP
  ) %>% 
  select(cas, activite, gainmarginal)

base <- base  %>% 
  mutate(
    revenu=as.character(activite)
  )

base$cas <- factor(base$cas, levels = c("isolé sans enfant", "couple monoactif deux enfants", "couple biactif sans enfant", "couple biactif deux enfants"))


graphG2 <- ggplot() +
  geom_col(data = base, aes(x = revenu, y = gainmarginal, fill = cas,
                            text = paste("cas-type : ", cas, "<br>Revenu: ", revenu, "<br>Gain Marginal: ", round(gainmarginal, 0))), 
           position = position_dodge(width = 0.6),  
           width = 0.4) +  
  theme_minimal() +
  scale_fill_brewer(palette = "Spectral") +
  scale_y_continuous(limits = c(0, 100)) +
  scale_x_discrete(expand = expansion(add = c(0.5, 0.5))) + 
  labs(title = " -Les taux marginaux d'imposition sont devenus plus élevés sur les revenus proches du smic à temps plein (gains plus faibles)",
       x = "Revenu individuel en parts de smic",
       y = "Taux de gain marginal",
       fill="") + 
  theme(
    # legend.position = "bottom",
    panel.background = element_rect(fill = "white"), 
    plot.background = element_rect(fill = "white"),
    axis.title.x = element_text(size = rel(1)),  
    axis.title.y = element_text(size = rel(1)),
    plot.title = element_text(size = rel(1.1), color = "#FDAE61", face = "bold"),
    legend.position = "right",
    legend.text = element_text(size = rel(1)),
    legend.title = element_blank(),
    plot.caption = element_text(size = rel(0.5)),
    plot.margin = margin(t = 20, r = 10, b = 40, l = 10),
    axis.ticks.y = element_blank(),
    axis.line = element_line(color = "black", linewidth = 0.2, linetype = "solid"),
    axis.text.x = element_text(size = rel(1), angle = 40, hjust = 1, vjust = 1)
    )

graphG2i <- ggplotly(graphG2, tooltip = "text",
    width = 950,   # largeur en pixels (à ajuster)
    height = 550,  # hauteur en pixels (à ajuster)
     legend = list(
      orientation = 'h',  
      x = 0.5,  
      xanchor = 'center',  
      y = -0.3,
      title = list(text = ""),
      itemwidth = 50,
      traceorder ='normal'
    )
  )


  graphG2i

```

## Que change la prise en compte des coûts de garde des jeunes enfants ? (isolé 1 enfant)

```{r}

castyp<-read.xlsx(file="cas types smic jeune enfant.xlsx",sheetName = "synthese") 

#  Isolé 1 enfant
smic=1398.7
nbuc=1.3
seuilpm=1309*nbuc


base<-castyp %>% 
  filter(isocou=="isolé" & nbenf==1) %>% 
  mutate(typrev=case_when(
    activite==0 ~ "Sans revenu",
    activite==0.5 ~ "Avec un mi-temps \n au Smic",
    activite==1 & Salaire==smic ~ "Avec un temps plein\n au Smic",
    TRUE ~ "Avec un temps plein \n à 1,5 Smic")
  ) %>% 
  select(typrev,CGNET,Salaire,PF,PL,RSA,PA, RDISP_NET_CG)	


RDmin=min(base$RDISP_NET_CG)

basegr<-base %>% 
  pivot_longer(cols=c(CGNET,Salaire,PF,PL,RSA,PA, RDISP_NET_CG)) 



basegr$typrev<-factor(basegr$typrev,levels=c("Sans revenu","Avec un mi-temps \n au Smic","Avec un temps plein\n au Smic","Avec un temps plein \n à 1,5 Smic"))

basegr$name<-factor(basegr$name, levels=rev(c("CGNET","Salaire", "PF", "PL", "RSA", "PA", "RDISP_NET_CG")))

graphI1 <- ggplot(basegr %>% filter(name !='RDISP_NET_CG'), aes(fill = name,
                                                       y = value, x = typrev)) + 
  scale_fill_manual(
    values = c("CGNET"="darkred","Salaire"= "#482677FF", "PF" = "#39568CFF", "PL" = "#238A8DFF", 
               "RSA" = "#55C667FF", "PA" = "#95D840FF"),
    labels = c("CGNET"="Coût net de la garde",
               "PA" = "Prime d'activité",
               "RSA" = "Revenu de solidarité active",
               "PF" = "Prestations familiales",
               "PL" = "Prestations logement",
               "Salaire" = "Salaire" 
    ),
    # guide = guide_legend(reverse = TRUE)  
  ) +
   geom_bar_interactive(
    position = "stack", 
    stat = "identity", 
    aes(y=value, fill=name,tooltip=paste(name,":", round(value,0), "euros"))
  ) +
    geom_point_interactive(
    data = basegr %>% filter(name == 'RDISP_NET_CG'), 
    aes(
      x = typrev, y = round(value, 2), 
      colour = "Revenu disponible net du coût de la garde", 
      tooltip=paste("Revenu disponible net du coût de la garde :",round(value,0), "euros, soit +",round(value-RDmin,0))), 
    size = 3
  ) +
  scale_color_manual(
    values = c("Revenu disponible net du coût de la garde" = "orange")  
  ) +
    guides(
    fill = guide_legend(order = 2),  # La légende des couleurs en premier
    colour=guide_legend(order = 1)
  ) +
  theme(
    panel.background = element_rect(fill = "white"), 
    plot.background = element_rect(fill = "white"),
    legend.position = "right",
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.text = element_text(size = rel(0.7)),
    legend.title = element_blank(),
    plot.title = element_text(size = rel(0.8), hjust = 0.7),
    plot.caption = element_text(size = rel(0.5)),
    plot.margin =  margin(t = 20, r = 10, b = 20, l = 10),
    axis.ticks.y = element_blank(),
    axis.line = element_line(color = "black", linewidth = 0.2, linetype = "solid"),
    axis.text.x = element_text(size = rel(0.9), angle = 40, hjust = 1,vjust = 1)
  ) +
  labs(title="",size=5,fill="")+
    theme(panel.border = element_blank())


igraphI1 <- girafe(
  ggobj = graphI1,
  options = list(
    opts_tooltip(
      css = "
        background-color: red ;
        color: white;
        padding: 6px;
        border-radius: 4px;
        font-size: 20px;
      "
    )
  )
)

igraphI1


```

## Que change la prise en compte des coûts de garde des jeunes enfants ? (couple 1 enfant - conjoint au Smic)

```{r}
smic=1398.7
nbuc=1.8
seuilpm=1309*nbuc

base<-castyp %>% 
  filter(isocou=="couple" & actconj=="1 smic" & nbenf==1) %>% 
  mutate(typrev=case_when(
    activite==0 ~ "Sans revenu",
    activite==0.5 ~ "Avec un mi-temps \n au Smic",
    activite==1 & Salaire==smic ~ "Avec un temps plein\n au Smic",
    TRUE ~ "Avec un temps plein \n à 1,5 Smic")
  ) %>% 
  select(typrev,CGNET,Ract_conj,Salaire,PF,PL,RSA,PA, RDISP_NET_CG)	

RDmin=min(base$RDISP_NET_CG)

basegr<-base %>% 
  pivot_longer(cols=c(CGNET,Ract_conj,Salaire,PF,PL,RSA,PA, RDISP_NET_CG)) 


basegr$typrev<-factor(basegr$typrev,levels=c("Sans revenu","Avec un mi-temps \n au Smic","Avec un temps plein\n au Smic","Avec un temps plein \n à 1,5 Smic"))

basegr$name<-factor(basegr$name, levels=rev(c("CGNET","Ract_conj","Salaire", "PF", "PL", "RSA", "PA", "RDISP_NET_CG")))

graphC1_S <- ggplot(basegr %>% filter(name !='RDISP_NET_CG'), aes(fill = name,
                                                                y = value, x = typrev)) + 
  scale_fill_manual(
    values = c("CGNET"="darkred",'Ract_conj' = '#440154FF',"Salaire"= "#482677FF", "PF" = "#39568CFF", "PL" = "#238A8DFF", 
               "RSA" = "#55C667FF", "PA" = "#95D840FF"),
    labels = c("CGNET"="Coût net de la garde",
               "PA" = "Prime d'activité",
               "RSA" = "RSA",
               "PF" = "Prestations familiales",
               "PL" = "Prestations logement",
               "Salaire" = "Salaire" ,
               "Ract_conj"="Salaire conjoint"
    ),
     ) +
   geom_bar_interactive(
    position = "stack", 
    stat = "identity", 
    aes(y=value, fill=name,tooltip=paste(name,":", round(value,0), "euros"))
  ) +
    geom_point_interactive(
    data = basegr %>% filter(name == 'RDISP_NET_CG'), 
    aes(
      x = typrev, y = round(value, 2), 
      colour = "Revenu disponible net du coût de la garde", 
      tooltip=paste("Revenu disponible net du coût de la garde :",round(value,0), "euros, soit +",round(value-RDmin,0))), 
    size = 3
  ) +
    scale_color_manual(
    values = c("Revenu disponible net du coût de la garde" = "orange")  
  ) +
    guides(
    fill = guide_legend(order = 2),  # La légende des couleurs en premier
    colour=guide_legend(order = 1)
  ) +
  theme(
    panel.background = element_rect(fill = "white"), 
    plot.background = element_rect(fill = "white"),
    legend.position =  "right",
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.text = element_text(size = rel(0.7)),
    legend.title = element_blank(),
    plot.title = element_text(size = rel(0.8), hjust = 0.7),
    plot.caption = element_text(size = rel(0.5)),
    plot.margin =  margin(t = 20, r = 10, b = 20, l = 10),
    axis.ticks.y = element_blank(),
    axis.line = element_line(color = "black", linewidth = 0.2, linetype = "solid"),
    axis.text.x = element_text(size = rel(0.9), angle = 40, hjust = 1,vjust = 1)
  ) +
  labs(title="",size=5)+
  #scale_y_continuous(expand = c(0, 0), limits = c(0, 4000), breaks = seq(0, 4000, by = 500)) + 
  theme(panel.border = element_blank())



graphC1_S

igraphC1_S <- girafe(
  ggobj = graphC1_S,
  options = list(
    opts_tooltip(
      css = "
        background-color: red ;
        color: white;
        padding: 6px;
        border-radius: 4px;
        font-size: 20px;
      "
    )
  )
)

igraphC1_S
```

## Taux effectif de gain à l'emploi pour une reprise d'emploi au Smic à temps-plein

```{r}

castyp<-read.xlsx(file="cas types smic.xlsx",sheetName = "synthese") 

base<-castyp %>% 
  mutate(
    casconj=case_when(isocou=="isolé" ~ "Sans conjoint",
                  isocou=="couple" & actconj=="Inactif" ~ "Conjoint sans revenu",
                  isocou=="couple" & actconj=="Chômeur" ~ "Conjoint chômeur",
                  isocou=="couple" & actconj=="1 smic" ~ "Conjoint salarié au smic",
                  TRUE ~ "Conjoint salarié à 1,5 smic"),
    enf=case_when(nbenf==0 ~ "0 enfant",
                  nbenf==1 ~ "1 enfant",
                  nbenf==2 ~ "2 enfants",
                  TRUE ~ "3 enfants"),
    cas=paste0(casconj," - ",enf),
    act=case_when(activite<1 ~ 100*activite,
                  Salaire==smic ~ 100,
                  TRUE ~ 150)
    ) %>% 
  select(casconj,enf,cas,Salaire,act,RDISP) 

basegr<-base %>% 
  pivot_wider(names_from=act, values_from = c(Salaire, RDISP)) %>% 
  mutate(
    var_rp_50=Salaire_50-Salaire_0,
    var_rd_50=RDISP_50-RDISP_0,
    TGM_50=100*(var_rd_50/var_rp_50),
    var_rp_100=Salaire_100-Salaire_0,
    var_rd_100=RDISP_100-RDISP_0,
    TGM_100=100*(var_rd_100/var_rp_100),
    var_rp_150=Salaire_150-Salaire_0,
    var_rd_150=RDISP_150-RDISP_0,
    TGM_150=100*(var_rd_150/var_rp_150),
 ) %>% 
  select(casconj,enf,cas,TGM_50,TGM_100,TGM_150)

basegr$enf <- factor(basegr$enf, levels=c("0 enfant","1 enfant","2 enfants","3 enfants"))


basegr$casconj <- factor(basegr$casconj,levels=c("Sans conjoint","Conjoint sans revenu",
                                               "Conjoint chômeur","Conjoint salarié au smic",
                                               "Conjoint salarié à 1,5 smic"))




graph4 <- ggplot() +
  geom_point(data=basegr, aes(x = casconj, y = TGM_100, colour = enf, 
                              text = paste0(
        "<span style='font-size:14px'>Taux effectif de gain à l'emploi: ", 
        number(TGM_100, accuracy = 1),"%", 
        "</span>"
      )
    ),
    size = 3
  ) +  
  theme_minimal() +
  scale_y_continuous(limits = c(25, 100)) + 
  labs(title = "Les taux de gains du passage à plein-temps sont plus hétèrogènes en présence d'un conjoint",colour="")+
  theme(
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.title = element_blank(),
    legend.text = element_text(size=rel(1.1)), 
    plot.margin = margin(t = 20, r = 10, b = 20, l = 10),
    axis.line = element_line(color = "black", linewidth = 0.2, linetype = "solid"),
    axis.text.x = element_text(size = rel(1.1), angle = 40, hjust = 1, vjust = 1),
    plot.title = element_text(size = rel(1.1), color="#5E4FA2")
  )

igraph4<-ggplotly(graph4, tooltip="text",
      width = 900,   # largeur en pixels (à ajuster)
    height = 600,  # hauteur en pixels (à ajuster)
     legend = list(
      orientation = 'v',  
      x = 1,  
      xanchor = 'left',  
      y = 0.5,
      title = list(text = ""),
      itemwidth=60,
      traceorder='normal'
    )
                   )
igraph4

```

## Taux effectif de gain à l'emploi pour une reprise d'emploi au Smic à mi-temps

```{r}

castyp<-read.xlsx(file="cas types smic.xlsx",sheetName = "synthese") 

base<-castyp %>% 
  mutate(
    casconj=case_when(isocou=="isolé" ~ "Sans conjoint",
                  isocou=="couple" & actconj=="Inactif" ~ "Conjoint sans revenu",
                  isocou=="couple" & actconj=="Chômeur" ~ "Conjoint chômeur",
                  isocou=="couple" & actconj=="1 smic" ~ "Conjoint salarié au smic",
                  TRUE ~ "Conjoint salarié à 1,5 smic"),
    enf=case_when(nbenf==0 ~ "0 enfant",
                  nbenf==1 ~ "1 enfant",
                  nbenf==2 ~ "2 enfants",
                  TRUE ~ "3 enfants"),
    cas=paste0(casconj," - ",enf),
    act=case_when(activite<1 ~ 100*activite,
                  Salaire==smic ~ 100,
                  TRUE ~ 150)
    ) %>% 
  select(casconj,enf,cas,Salaire,act,RDISP) 

basegr<-base %>% 
  pivot_wider(names_from=act, values_from = c(Salaire, RDISP)) %>% 
  mutate(
    var_rp_50=Salaire_50-Salaire_0,
    var_rd_50=RDISP_50-RDISP_0,
    TGM_50=100*(var_rd_50/var_rp_50),
    var_rp_100=Salaire_100-Salaire_0,
    var_rd_100=RDISP_100-RDISP_0,
    TGM_100=100*(var_rd_100/var_rp_100),
    var_rp_150=Salaire_150-Salaire_0,
    var_rd_150=RDISP_150-RDISP_0,
    TGM_150=100*(var_rd_150/var_rp_150),
 ) %>% 
  select(casconj,enf,cas,TGM_50,TGM_100,TGM_150)

# basegr$enf <- factor(basegr$enf, levels=c("0 enfant","1 enfant","2 enfants","3 enfants"))

basegr$casconj <- factor(basegr$casconj,levels=c("Sans conjoint","Conjoint sans revenu",
                                               "Conjoint chômeur","Conjoint salarié au smic",
                                               "Conjoint salarié à 1,5 smic"))



graph4b <- ggplot() +
  geom_point(data=basegr, aes(x = casconj, y = TGM_50, colour = enf, text = paste("Taux effectif de gain à l'emploi:", number(TGM_50, accuracy = 1))
  ), size = 3) +  
  theme_minimal() +
  scale_y_continuous(limits = c(25, 100)) + 
  labs(title = "Les taux de gains sont plus faibles quand le conjoint travaille",colour="")+
  theme(
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.title = element_blank(),
    legend.text = element_text(size=rel(1.1)), 
    plot.margin = margin(t = 20, r = 10, b = 20, l = 10),
    axis.line = element_line(color = "black", linewidth = 0.2, linetype = "solid"),
    axis.text.x = element_text(size = rel(1.1), angle = 40, hjust = 1, vjust = 1),
    plot.title = element_text(size = rel(1.1), color="#5E4FA2")
  )

igraph4b<-ggplotly(graph4b, tooltip="text",
                       width = 900,   # largeur en pixels (à ajuster)
    height = 600,  # hauteur en pixels (à ajuster)
     legend = list(
      orientation = 'v',  
      x = 1,  
      xanchor = 'left',  
      y = 0.5,
      title = list(text = ""),
      itemwidth=60,
      traceorder='normal'
    )
                   )


igraph4b




```

# 2. L'emploi ne protège pas toujours de la pauvreté

## Niveau de vie et risque de pauvreté avec un emploi au Smic à mi-temps

```{r}

castyp<-read.xlsx(file="cas types smic.xlsx",sheetName = "synthese") 

base<-castyp %>% 
  mutate(
    casconj=case_when(isocou=="isolé" ~ "Sans conjoint",
                  isocou=="couple" & actconj=="Inactif" ~ "Conjoint sans revenu",
                  isocou=="couple" & actconj=="Chômeur" ~ "Conjoint chômeur",
                  isocou=="couple" & actconj=="1 smic" ~ "Conjoint salarié au smic",
                  TRUE ~ "Conjoint salarié à 1,5 smic"),
    enf=case_when(nbenf==0 ~ "0 enfant",
                  nbenf==1 ~ "1 enfant",
                  nbenf==2 ~ "2 enfants",
                  TRUE ~ "3 enfants"),
    cas=paste0(casconj," - ",enf),
    act=case_when(activite<1 ~ 100*activite,
                  Salaire==smic ~ 100,
                  TRUE ~ 150)
    ) %>% 
  select(casconj,enf,cas,Salaire,act,NVIE) 

seuilpm=1309

basegr<-base %>% filter(act==50)

basegr$enf <-factor(basegr$enf, levels=c("0 enfant","1 enfant","2 enfants","3 enfants"))

basegr$casconj <- factor(basegr$casconj,levels=c("Sans conjoint","Conjoint sans revenu",
                                               "Conjoint chômeur","Conjoint salarié au smic",
                                           "Conjoint salarié à 1,5 smic"))

graphtppm <- ggplot() +
  geom_point(data=basegr, aes(x = casconj, y = NVIE, colour = enf, text = paste("Revenu disponible:", round(NVIE, 0),"euros")
  ), size = 3) +  
    geom_hline(
  aes(yintercept = (4/6)*seuilpm, linetype = "Seuil de grande pauvreté monétaire"),color = "grey40",linewidth = 0.5
  )+
    geom_hline(
      aes(yintercept = seuilpm,linetype = "Seuil de pauvreté monétaire"),
    color = "grey40",linewidth = 0.5
    )+
  scale_linetype_manual(name = "", values = c("Seuil de pauvreté monétaire" = "solid", "Seuil de grande pauvreté monétaire" = "dashed"),
                        limits = c("Seuil de pauvreté monétaire", "Seuil de grande pauvreté monétaire"))+
    guides(
    colour = guide_legend(order = 1),  # La légende des couleurs en premier
    linetype = guide_legend(order = 2) # La légende des lignes en dernier
  ) +
  theme_minimal() +
  scale_y_continuous(limits = c(0, 2000)) + 
  theme(
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.title = element_blank(),
    legend.text = element_text(size = rel(1)),
    plot.margin = margin(t = 20, r = 10, b = 20, l = 10),
    axis.line = element_line(color = "black", linewidth = 0.2, linetype = "solid"),
    axis.text.x = element_text(size = rel(1), angle = 40, hjust = 1, vjust = 1),
    plot.title = element_text(size = rel(1.1), color="#5E4FA2")
  )


igraphtppm <- girafe(
  ggobj = graphtppm,
  options = list(
    opts_tooltip(
      css = "
        background-color: red ;
        color: white;
        padding: 6px;
        border-radius: 4px;
        font-size: 20px;
      "
    )
  )
)


# igraphtppm<-ggplotly(graphtppm, tooltip="text",
#                        width = 900,   # largeur en pixels (à ajuster)
#     height = 600,  # hauteur en pixels (à ajuster)
#      legend = list(
#       orientation = 'v',
#       x = 1,
#       xanchor = 'left',
#       y = 0.5,
#       title = list(text = ""),
#       itemwidth=60,
#       traceorder='normal'
#     )
#      ) 


igraphtppm
```

## Niveau de vie et risque de pauvreté avec un emploi au Smic à temps complet

```{r}
castyp<-read.xlsx(file="cas types smic.xlsx",sheetName = "synthese") 

base<-castyp %>% 
  mutate(
    casconj=case_when(isocou=="isolé" ~ "Sans conjoint",
                  isocou=="couple" & actconj=="Inactif" ~ "Conjoint sans revenu",
                  isocou=="couple" & actconj=="Chômeur" ~ "Conjoint chômeur",
                  isocou=="couple" & actconj=="1 smic" ~ "Conjoint salarié au smic",
                  TRUE ~ "Conjoint salarié à 1,5 smic"),
    enf=case_when(nbenf==0 ~ "0 enfant",
                  nbenf==1 ~ "1 enfant",
                  nbenf==2 ~ "2 enfants",
                  TRUE ~ "3 enfants"),
    cas=paste0(casconj," - ",enf),
    act=case_when(activite<1 ~ 100*activite,
                  Salaire==smic ~ 100,
                  TRUE ~ 150)
    ) %>% 
  select(casconj,enf,cas,Salaire,act,NVIE) 

seuilpm=1309

basegr<-base %>% filter(act==100)

basegr$enf <- factor(basegr$enf, levels=c("0 enfant","1 enfant","2 enfants","3 enfants"))

basegr$casconj <- factor(basegr$casconj,levels=c("Sans conjoint","Conjoint sans revenu",
                                               "Conjoint chômeur","Conjoint salarié au smic",
                                               "Conjoint salarié à 1,5 smic"))



graphtcpm <- ggplot() +
  geom_point(data=basegr, aes(x = casconj, y = NVIE, colour = enf, text = paste("Taux effectif de gain à l'emploi:", number(NVIE, accuracy = 1))
  ), size = 3) +  
    geom_hline(
  aes(yintercept = (4/6)*seuilpm, linetype = "Seuil de grande pauvreté monétaire"),
              color = "grey40",linewidth = 0.5)+
    geom_hline(aes(yintercept = seuilpm,linetype = "Seuil de pauvreté monétaire"),
    color = "grey40",linewidth = 0.5)+
  scale_linetype_manual(name = "Références", values = c("Seuil de pauvreté monétaire" = "solid", "Seuil de grande pauvreté monétaire" = "dashed"),
                        limits = c("Seuil de pauvreté monétaire", "Seuil de grande pauvreté monétaire"))+
    guides(
    colour = guide_legend(order = 1),  # La légende des couleurs en premier
    linetype = guide_legend(order = 2) # La légende des lignes en dernier
  ) +
  theme_minimal() +
  scale_y_continuous(limits = c(0, 2500)) + 
  theme(
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.title = element_blank(),
    plot.margin = margin(t = 20, r = 10, b = 20, l = 10),
    axis.line = element_line(color = "black", linewidth = 0.2, linetype = "solid"),
    axis.text.x = element_text(size = rel(0.9), angle = 40, hjust = 1, vjust = 1),
    plot.title = element_text(size = 10, color="#5E4FA2")
  )


igraphtcpm <- girafe(
  ggobj = graphtcpm,
  options = list(
    opts_tooltip(
      css = "
        background-color: red ;
        color: white;
        padding: 6px;
        border-radius: 4px;
        font-size: 20px;
      "
    )
  )
)
# igraphtcpm<-ggplotly(graphtcpm, tooltip="text",
#                        width = 900,   # largeur en pixels (à ajuster)
#     height = 600,  # hauteur en pixels (à ajuster)
#      legend = list(
#       orientation = 'v',  
#       x = 1,  
#       xanchor = 'left',  
#       y = 0.5,
#       title = list(text = ""),
#       itemwidth=60,
#       traceorder='normal'
#     )
#                    )


igraphtcpm
```

## Taux de pauvreté en fonction du revenu d'activité

```{r}

castypp<-read.xlsx(file="Sorties_Privation.xlsx",sheetName = "Sorties_Privation")

base <- castypp %>%
pivot_longer(cols = c(TX_PAUVRETE, TX_ISO_PAUVRETE, TX_COU_PAUVRETE), names_to = "cas", values_to = "taux") %>%
  select(modalite, cas, taux) %>%
  filter(modalite!="Ensemble")


base <- base %>%
  mutate(cas = fct_recode(cas,
                              "Ensemble" = "TX_PAUVRETE",
                              "Célibataire" = "TX_ISO_PAUVRETE", 
                              "En couple"= "TX_COU_PAUVRETE" ),
         taux=taux*100)

base$modalite<-factor(base$modalite, levels=c("moins de 0,3 smic", "[0,3 à 0,6[", "[0,6 à 0,9[", "[0,9 à 1,2[", "[1,2 à 1,5[", "[1,5 à 1,8[", "1,8 smic et plus"))


graphG <- ggplot() +
  geom_col(data = base, aes(x = modalite, y = taux, fill = cas,
                            text = paste("cas: ", cas, "<br>salaire:", modalite, "<br>taux de pauvreté: ", round(taux,1),"%"
                                         )), 
           position = position_dodge(width = 0.6),  # Position des barres
           width = 0.4) +  # Largeur des barres
  theme_minimal() +
  scale_fill_brewer(palette = "Spectral") +
  scale_y_continuous(limits = c(0, 51)) +
  #scale_x_discrete(expand = expansion(add = c(0.5, 0.5))) + 
  labs(title = "Source SRCV 2022",
       x = "Revenu en tranche de Smic",
       y = "Taux de pauvreté monétaire",fill="") + 
  theme(
    legend.position = "right",
    legend.title = element_blank(),
    legend.text = element_text(size = rel(1)),  
    axis.title.x = element_text(size = rel(0.8)),  
    axis.title.y = element_text(size = rel(0.8)), 
    axis.text.x = element_text(angle = 45, hjust = 1, size = rel(1)),
    plot.title = element_text(size = 12, color = "#FDAE61", face = "bold")
    )+
  guides(fill = guide_legend(nrow = 3))   

graphGi <- ggplotly(graphG, tooltip = "text",
    width = 950,   # largeur en pixels (à ajuster)
    height = 550,  # hauteur en pixels (à ajuster)
         legend = list(
      orientation = 'v',
      x = 1,
      xanchor = 'left',
      y = 1,
      title = list(text = ""),
      itemwidth=60,
      traceorder='normal'
    )
  )


graphGi

```

## Taux de privation matérielle en fonction du revenu d'activité

```{r}

castypp<-read.xlsx(file="Sorties_Privation.xlsx",sheetName = "Sorties_Privation")


base2 <- castypp %>%
pivot_longer(cols = c(TX_PMS, TX_ISO_PMS, TX_COU_PMS), names_to = "cas", values_to = "taux") %>%
  select(modalite, cas, taux) %>%
  filter(modalite!="Ensemble")


base2 <- base2 %>%
  mutate(cas = fct_recode(cas,
                              "Ensemble" = "TX_PMS",
                              "Célibataire" = "TX_ISO_PMS", 
                              "En couple"= "TX_COU_PMS" ),
         taux=taux*100)

base2$modalite<-factor(base2$modalite, levels=c("moins de 0,3 smic", "[0,3 à 0,6[", "[0,6 à 0,9[", "[0,9 à 1,2[", "[1,2 à 1,5[", "[1,5 à 1,8[", "1,8 smic et plus"))


graphG2 <- ggplot() +
  geom_col(data = base2, aes(x = modalite, y = taux, fill = cas,
                            text = paste("cas: ", cas, "<br>salaire:", modalite, "<br>taux de pauvreté: ", round(taux,1),"%"
                                         )), 
           position = position_dodge(width = 0.6),  # Position des barres
           width = 0.4) +  # Largeur des barres
  theme_minimal() +
  scale_fill_brewer(palette = "Spectral") +
  scale_y_continuous(limits = c(0, 30)) +
  #scale_x_discrete(expand = expansion(add = c(0.5, 0.5))) + 
  labs(title = "Source SRCV 2022",
       x = "Revenu en tranche de Smic",
       y = "Taux de privations matérielles et sociales",fill="") + 
  theme(
    legend.position = "right",
    legend.title = element_blank(),
    axis.title.x = element_text(size = rel(0.8)),  
    axis.title.y = element_text(size = rel(0.8)), 
    legend.text = element_text(size = rel(1)),
    axis.text.x = element_text(angle = 45, hjust = 1, size = rel(1)),
    plot.title = element_text(size = 12, color = "#FDAE61", face = "bold")
    )+
  guides(fill = guide_legend(nrow = 3))   

graphGi2 <- ggplotly(graphG2, tooltip = "text",
    width = 950,   # largeur en pixels (à ajuster)
    height = 550,  # hauteur en pixels (à ajuster)
         legend = list(
      orientation = 'v',
      x = 1,
      xanchor = 'left',
      y = 1,
      title = list(text = ""),
      itemwidth=60,
      traceorder='normal'
    )
  )


graphGi2



```

# 3. Le revers des incitations est l'augmentation de l'intensité de la pauvreté des personnes sans emploi

## Pour les couples, le RSA ne permet plus de franchir le seuil de grande pauvreté (40%)

```{r}

castyp<-read.xlsx(file="cas types smic.xlsx",sheetName = "synthese") 
seuilpm=1308
seuil60=seuilpm
seuil50=seuilpm*5/6
seuil40=seuilpm*4/6

base<-castyp %>% 
  filter(activite==0, Ract_conj==0) %>% 
  mutate(
       enf=case_when(nbenf==0 ~ "0 enfant",
                  nbenf==1 ~ "1 enfant",
                  nbenf==2 ~ "2 enfants",
                  TRUE ~ "3 enfants")
    ) %>% 
  select(isocou, enf, NVIE)


graph5 <- ggplot(base, aes(x = isocou, y = NVIE, fill = enf)) + 
  geom_bar_interactive(stat = "identity", position = "dodge", 
    aes(y=NVIE, fill=enf,tooltip=paste("niveau de vie :",round(NVIE,0), "euros"))
  ) + 
  scale_fill_economist() +  
  theme_minimal() +
  scale_y_continuous(limits = c(0, 1500)) +  
    geom_hline(
  aes(yintercept = (4/6)*seuilpm, linetype = "Seuil de grande pauvreté monétaire"),
              color = "grey40",linewidth = 0.5)+
    geom_hline(aes(yintercept = seuilpm,linetype = "Seuil de pauvreté monétaire"),
    color = "grey40",linewidth = 0.5)+
  scale_linetype_manual(name = "Références", values = c("Seuil de pauvreté monétaire" = "solid", "Seuil de grande pauvreté monétaire" = "dashed"),
                        limits = c("Seuil de pauvreté monétaire", "Seuil de grande pauvreté monétaire"))+
    guides(
    fill = guide_legend(order = 1),  # La légende des couleurs en premier
    linetype = guide_legend(order = 2) # La légende des lignes en dernier
  ) +
  theme(
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.title = element_blank(),
    plot.margin = margin(t = 20, r = 10, b = 70, l = 10),
    axis.line = element_line(color = "black", linewidth = 0.2, linetype = "solid"),
    axis.text.x = element_text(size = rel(0.9), angle = 40, hjust = 1, vjust = 1)
  )

igraph5<-girafe(ggobj = graph5)

igraph5

```

## Depuis 1990, le niveau RMI/RSA évolue moins vite que les autres minima sociaux, et beaucoup moins vite que le Smic horaire

```{r fig-minimasociaux}


Bareme <- read_excel("DREES-BaremesMS.xlsx")
Bareme <-Bareme %>% mutate_all(as.numeric)

IPC2015 <- "https://www.bdm.insee.fr/series/sdmx/data/SERIES_BDM/001763852" %>%
  readSDMX %>%
  as_tibble

IPC <- IPC2015 %>%  
  mutate(
  OBS_VALUE=as.numeric(OBS_VALUE),
  TIME=ym(TIME_PERIOD),
  year=year(TIME),
  month=month(TIME),
   ) %>%  
   select(TIME,year, month,OBS_VALUE)  %>% 
   filter(month==1)

Bareme_IPC <- left_join(Bareme, IPC, by="year")

Bareme_IPC <- Bareme_IPC %>% 
  mutate(
    IPC2015=OBS_VALUE,
    RMIcst=RMI/IPC2015*100,
    AAHcst=AAH/IPC2015*100,
    ASPAcst=ASPA/IPC2015*100,
    SMICcst=(SMIC)/IPC2015*100,
  )  

annee_ref <- 1990

# Transformation en base 100

Bareme_base100 <- Bareme_IPC %>%
  mutate(
    "RMI/RSA" = (RMIcst / RMIcst[year == annee_ref]) * 100,
    "AAH" = (AAHcst/AAHcst[year==annee_ref]*100),
    "ASPA" = (ASPAcst/ASPAcst[year==annee_ref]*100),
    "SMIC horaire" = (SMICcst/SMICcst[year==annee_ref]*100)
  )

Bareme_long <- pivot_longer(
  Bareme_base100,
  cols = c("SMIC horaire", "AAH", "ASPA", "RMI/RSA"), 
  names_to = "variables", 
  values_to ="valeurs") %>% 
  select(year, variables, valeurs) %>% 
  filter(year>1989)

Bareme_long$variables<-factor(Bareme_long$variables, levels=rev(c("RMI/RSA", "ASPA", "AAH", "SMIC horaire")))


#Graphique


graph4 <- Bareme_long %>%
    ggplot() +
  aes(x = year, y = valeurs, color = variables) +
  geom_line() +
  geom_point_interactive(
    aes(tooltip = paste("Année:   ", year, "   ;", variables, ": ", round(valeurs, 0))),
    size = 1
  ) +
  theme_minimal()+
  scale_y_continuous(limits = c(90, 150)) +  
  scale_color_brewer(palette = "Set2") +
  labs(caption="Source : DREES ; 
       base 100 = 1990 ; Smic horaire et minima sociaux en euros constants")+
  labs(x="", y="")+
  theme(
    text = element_text(size=12),
    legend.title = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    plot.margin =  margin(t = 20, r = 10, b = 70, l = 10)
        )


igraph4 <- girafe(ggobj = graph4)

igraph4


```

# 4. Peut-on dépasser les dilemmes du système social ?

## Avantages et limites d’une augmentation du socle

**Si les personnes en emploi restent pauvres malgré les allocations et les incitations… c’est qu’elles partent de trop bas**.

-   Il est possible de concilier les trois objectifs - *travail rémunérateur, travail permettant de sortir de la pauvreté et niveau de vie minimum suffisamment élevé* - en **relevant le montant des prestations de solidarité** (RSA et aides au logement) et en gardant un minimum d’incitations.

-   Cette réforme est la **plus juste** : elle réduit fortement les inégalités avec, probablement, de très faibles coûts en termes d’efficacité et d’emploi (voir par exemple Bargain, 2014 et Simmonet et Danzin, 2014).

-   Mais **cette réforme est aussi la plus coûteuse :** augmenter le socle à 900 euros avec une légère baisse du taux de cumul de la prime d’activité aurait un coût d’environ **24 milliards d’euros** (11 milliards de RSA et 13 milliards de prime d’activité).

Le dilemme entre redistribution et incitation est en fait un **triangle d’incompatibilité entre redistribution, incitations monétaires et coût budgétaire** (Bozio et Grenet 2017).

## Ne pas annihiler les coups de pouce

**Pour les personnes au RSA ou à la prime d'activité, chaque euro perçu est déduit de la prestation** .

-   source d'indus quand les allocataires ne pensent pas à déclarer une aide familiale ponctuelle ou un petit boulot

-   le niveau du RSA est insuffisant pour boucler les fin de moi. Pourquoi ne pas autoriser le cumul avec des faibles revenus (modèle de l'ASF)

-   Simulation d'une réforme à coût constants : ne pas déclarer les revenus inférieurs à 450 par trimestre quelle que soit leur nature et réduite le taux e cumul avec les revenus d'activité de 61% à 58,5%

    *Des gagnants dans le 1er décile, des perdants (pour de faibles montants) dans le 4ème décile*

## **Soutenir les emplois à temps partiel ou promouvoir la norme du temps plein ?**

**Le problème est insoluble** :

-   pour **protéger de la pauvreté**, il vaut mieux inciter au temps-plein ;

-   pour **réduire la pauvreté laborieuse**, il vaut mieux donner plus aux travailleurs à temps-partiel, qui ont des niveaux de vie plus faibles.

L'objectif de **rémunérer le « mérite »** ne résout pas le problème car **deux philosophies** s'opposent.

-   **le travail à temps-plein doit payer :** Il faudrait créer une norme de temps-plein, forme d’emploi la plus propice à réduire la pauvreté.

-   **chaque heure de travail doit payer**, c’est-à-dire mérite une hausse du revenu disponible : créer un écart de revenus à la fois entre l’inactivité et le mi-temps et entre le mi-temps et le temps-plein exerce une pression à la baisse sur le niveau des revenus d’assistance.

## **Augmenter les gains à l’emploi par la hausse du Smic ou grâce à la prime d’activité ?**

Faut-il privilégier le soutien aux bas-salaires via le Smic (les salaires) ou via la prime d’activité et ses bonus individuels renforcés à la suite de la crise des gilets jaunes ? Smic et prime d’activité ne sont pas équivalents car la prime d’activité n’est pas un salaire :

-   **Le salaire est totalement individualisé** : le bénéfice de la prime pour un travailleur à bas salaire dépend de la composition de sa famille, du montant et de la nature des revenus de son conjoint

-   **Le salaire est plus prévisible pour les travailleurs.** Ils peuvent difficilement anticiper le montant de la prime d’activité compte tenu de son mode de calcul et des risques d’indus et de suspension/rappels

-   **le salaire procure des droits sociaux** : le taux de remplacement au chômage ou à la retraite est réduit pour les bénéficiaires de la prime si l’on raisonne en revenus nets.

## **Deux objectifs, deux instruments**

Selon le principe de Tinbergen, **lorsqu’il y a deux objectifs distincts, ici la lutte contre la pauvreté et les gains à l’emploi, il faut affecter à des instruments distincts la poursuite de ces objectifs**.

Dans cette optique, on pourrait considérer que

-   le **RSA et une prime d’activité entièrement familialisée** (sans bonus individuels) ont pour seul objectifs de lutter contre la pauvreté et les inégalités de niveau de vie

    *Possibilité d'inclure les allocations chômage dans les "revenus d'activité"*

-   une **norme de salaire minimum mensuel**, et non plus horaire (Smic + norme de l'emploi à temps plein) vise à assurer des gains à l'emploi suffisants

    *Eviter que les entreprises s'appuient sur le système social pour offrir des emplois qui ne sont pas viables*
