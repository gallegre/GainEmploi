---
title: "La reprise d'emploi est-elle toujours rémunératrice?"
subtitle: "Séminaire IRES-OFCE"
author-footer: Allegre-Pucci
date: 2025-06-13
format: 
  pres-revealjs:
    toc-depth: 1
    embed-resources: true
---

```{r, include=FALSE}
ofce::init_qmd()

library(knitr) 
library(tidyverse) 
library(ofce) 
library(lubridate) 
library(knitr) 
library(scales) 
library(dplyr) 
library(tibble) 
library(readxl) 
library(skimr) 
library(tidyr) 
library(rsdmx) 
library(ggthemes) 
library(haven)
library(glue)
library(readr)
library(reshape2)
library(MetricsWeighted)
library(questionr)
library(xlsx)
library(patchwork)
library(ggplot2)
library(ggrepel)
library(blorr)
library(plotly)
library(ggiraph)
library(sf) 
library(RColorBrewer)
library(viridis)
library(ggsci)
library(quarto)
library(patchwork)
```

# Propos introductif

## Pourquoi cette question aujourd'hui ? {.smaller}

La réponse à une commande d'Alternatives Economiques :

![](Images/AE_Allegre_Pucci.png){width="513"}

<https://www.alternatives-economiques.fr/non-on-ne-gagne-plus-allocations-quen-travaillant/00112653>

## Une question récurrente

Rapport Hirsch ("Au possible, nous sommes tenus", 2005) :

![](Images/Rapport-Hirsch.PNG){fig-align="center"}

Proposition d'ACR (Roger Godino : Pour une réforme du RMI, 1999), ici en entretien (2003) :

![](Images/Godino_ACR.png){fig-align="center" width="672"}

## Les objectifs de la stratégie nationale de prévention et de lutte contre la pauvreté (SNPLP)

On peut dégager **trois objectifs de la SNPLP** (en réalité, les mêmes que dans le rapport Hirsch) :

-   Faire en sorte que le travail paye et de la même façon dans tous les cas

-   Faire en sorte que le travaille permette d'échapper à la pauvreté

-   Garantir un soutien financier aux ménages modestes

    en lien avec le préambule de la constitution : "[Tout être humain qui, en raison de son âge, de son état physique ou mental, de la situation économique, se trouve dans l'incapacité de travailler a le droit d'obtenir de la collectivité des moyens convenables d'existence]{style="color : red"}"

# 1. La reprise d'emploi est toujours rémunératrice mais de façon hétérogène

## Des reprises d'emploi rémunératrices {.smaller}

```{r}
#| label: fig-C1A0E
#| fig-cap: Revenu disponible d'une personne seule selon son revenu professionnel

castyp<-read.xlsx(file="cas types smic.xlsx",sheetName = "synthese") 

smic=1398.7

base<-castyp %>% 
  filter(isocou=="isolé" & nbenf==0) %>% 
  mutate(typrev=case_when(
    activite==0 ~ "Sans revenu",
    activite==0.5 ~ "Avec un mi-temps \n au Smic",
    activite==1 & Salaire==smic ~ "Avec un temps plein\n au Smic",
    TRUE ~ "Avec un temps plein \n à 1,5 Smic")
  ) %>% 
  mutate(
    seuil60 = 1309
  ) %>% 
  select(typrev,Salaire,PF,PL,RSA,PA, RDISP, seuil60)	

basegr<-base %>% 
  pivot_longer(cols=c(Salaire,PF,PL,RSA,PA, RDISP)) 

seuilpm=1309


basegr$typrev<-factor(basegr$typrev,levels=c("Sans revenu","Avec un mi-temps \n au Smic","Avec un temps plein\n au Smic","Avec un temps plein \n à 1,5 Smic"))

basegr$name<-factor(basegr$name, levels=rev(c("Salaire", "PF", "PL", "RSA", "PA", "RDISP")))

graph <- ggplot(basegr %>% filter(name !='RDISP'), aes(fill = name,
  y = value, x = typrev)) + 
  scale_fill_manual(
    values = c("Salaire" = "#482677FF", "PF" = "#39568CFF", "PL" = "#238A8DFF", 
               "RSA" = "#55C667FF", "PA" = "#95D840FF"),
  labels = c("PA" = "Prime d'activité",
             "RSA" = "Revenu de solidarité active",
             "PF" = "Prestations familiales",
             "PL" = "Prestations logement",
             "Salaire" = "Salaire"),
    guide = guide_legend(reverse = TRUE)  
  ) +
   geom_bar_interactive(
    position = "stack", 
    stat = "identity", 
    aes(y=value, fill=name,tooltip=paste(name, ":", round(value,0),"euros"))
  ) +
    geom_point_interactive(
    data = basegr %>% filter(name == 'RDISP'), 
    aes(
      x = typrev, y = round(value, 2), 
      colour = "Revenu disponible", 
      tooltip=paste("Revenu disponible",round(value,0), "euros")), 
    size = 3
  ) +
    geom_hline(
  aes(yintercept = (4/6)*seuilpm, linetype = "Seuil de grande pauvreté monétaire"),
              color = "grey40",linewidth = 0.5)+
    geom_hline(aes(yintercept = seuilpm,linetype = "Seuil de pauvreté monétaire"),
    color = "grey40",linewidth = 0.5)+
  scale_linetype_manual(name = "Références", values = c("Seuil de pauvreté monétaire" = "solid", "Seuil de grande pauvreté monétaire" = "dashed"),
                        limits = c("Seuil de pauvreté monétaire", "Seuil de grande pauvreté monétaire"))+
    guides(
    fill = guide_legend(order = 1),  # La légende des couleurs en premier
    colour=guide_legend(order = 2),
    linetype = guide_legend(order = 3) # La légende des lignes en dernier
  ) +
  theme(
    panel.background = element_rect(fill = "white"), 
    plot.background = element_rect(fill = "white"),
    legend.position =  "right",
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    legend.text = element_text(size = rel(0.7)),
    legend.title = element_blank(),
    plot.title = element_text(size = rel(0.8), hjust = 0.7),
    plot.caption = element_text(size = rel(0.5)),
    plot.margin =  margin(t = 20, r = 10, b = 20, l = 10),
    axis.ticks.y = element_blank(),
    axis.line = element_line(color = "black", linewidth = 0.2, linetype = "solid"),
    axis.text.x = element_text(size = rel(0.9), angle = 40, hjust = 1,vjust = 1)
  ) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 2250), breaks = seq(0, 2250, by = 250)) + 
  theme(panel.border = element_blank())

igraph <- girafe(ggobj = graph)

igraph


```
